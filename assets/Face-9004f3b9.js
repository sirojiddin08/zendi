import{A as Ue,u as Ge,B as Ke,r as c,w,C as Ze,o as Xe,f as m,b as j,c as q,g as e,k as _e,l as be,i as r,n as u,v as xe,F as we,a as L,E as ke,t as a,j as x,G as Q,H as G,h as Qe,I as K}from"./index-aae41fd2.js";import{l as Ye,u as et,T as tt}from"./2-61298274.js";import{_ as ot,k as lt,s as st,c as nt,u as at,a as it}from"./uni-6eec2ede.js";import{b as ct}from"./bridge-820ebe1a.js";import"./index-c3a3a22d.js";const dt={class:"grid mapSection"},rt={class:"col-9"},ut={class:"card p-1",style:{position:"relative",overflow:"hidden"}},pt={class:"layer-cog"},mt={class:"layers"},ft={class:"text-xs layer-name"},gt=e("div",{id:"map",class:"p-1",style:{height:"88vh",position:"relative"}},null,-1),yt={class:"grid p-0 m-0",style:{width:"300px"}},ht={class:"col-12 py-2"},vt={for:"regions"},_t={class:"col-12 py-2"},bt={for:"districts"},xt={class:"col-12 py-2"},wt={class:"p-0"},kt={class:"p-0"},It=e("div",{class:"col-3"},[e("div",{class:"card h-full"})],-1),St={class:"mb-0 pb-0"},jt={class:"font-bold whitespace-nowrap mb-0 pb-0 text-2xl"},Lt=e("div",{id:"playWind",style:{width:"1110px",height:"670px",display:"none"}},null,-1),$t=e("div",{class:"rounded",id:"offline_bg"},[e("span",null,"Kamera offline!")],-1),Ct={class:"items m-2 mt-6 flex"},Bt={class:"grid",style:{width:"180px","margin-left":"-0.4rem"}},Tt={class:"col-4 p-0"},Et=e("i",{class:"pi pi-window-maximize"},null,-1),Pt=[Et],Ft=e("div",{class:"col-4 p-0 unmute",style:{display:"none"}},[e("button",{class:"o-button o-button-success",type:"button"},[e("i",{class:"pi pi-volume-up"})])],-1),Mt=e("div",{class:"col-4 p-0 mute"},[e("button",{class:"o-button o-button-danger",type:"button"},[e("i",{class:"pi pi-volume-off"})])],-1),zt={class:"col-4 p-0"},qt=e("i",{class:"pi pi-camera"},null,-1),Vt=[qt],Dt={class:"grid w-full",style:{"margin-left":"30px","font-size":"18px"}},Ot={class:"xl:col-9 md:col-6 p-0 mt-1 pl-2"},At={style:{display:"inline"}},Jt={class:"ml-2"},Nt={class:"xl:col-3 md:col-6 p-0"},Wt={for:"camera"},Ht={key:0,class:"flex items-center"},Rt={key:1},Ut={class:"flex items-center"},Gt=["onClick"],Kt={class:"bg-transparent border-none inline-flex flex-column gap-2"},Zt=e("i",{class:"pi pi-building text-900 text-2xl"},null,-1),Xt=[Zt],Qt={class:"grid grid-nogutter text-800"},Yt={class:"col-12 md:col-5 text-center md:text-left flex"},eo={class:"",style:{width:"100%"}},to={class:"list-none p-0 m-0",style:{width:"100%"}},oo={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},lo={class:"text-500 w-6 md:w-4 font-medium"},so={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},no={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},ao={class:"text-500 w-6 md:w-4 font-medium"},io={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},co={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},ro={class:"text-500 w-6 md:w-4 font-medium"},uo={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},po={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},mo={class:"text-500 w-6 md:w-4 font-medium"},fo={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},go={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},yo={class:"text-500 w-6 md:w-4 font-medium"},ho={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},vo={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},_o={class:"text-500 w-6 md:w-4 font-medium"},bo={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},xo={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},wo={class:"text-500 w-6 md:w-4 font-medium"},ko={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},Io={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},So={class:"text-500 w-6 md:w-4 font-medium"},jo={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},Lo={class:"col-12 md:col-7"},$o={class:"flex align-items-center justify-content-center flex-column"},Co={class:"col-12 mt-3"},Bo={class:"flex pt-4 justify-content-end"},To=["onClick"],Eo={class:"bg-transparent border-none inline-flex flex-column gap-2"},Po=e("i",{class:"pi pi-users text-900 text-2xl"},null,-1),Fo=[Po],Mo={key:0,class:"grid p-2"},zo={class:"h-full"},qo={class:"shadow-2 p-0 h-full flex flex-column card",style:{"border-radius":"6px"}},Vo={class:"mb-2 flex align-items-center justify-content-center header_img",style:{height:"300px","flex-direction":"column"}},Do=["src"],Oo=["src","onClick"],Ao={style:{width:"200px"},class:"text-center mt-2 text-lg"},Jo={class:"flex pt-3 align-items-center px-3"},No=e("h6",{class:"font-bold m-0 p-0"},[e("i",{class:"pi pi-phone text-2xl mt-1 mr-3"})],-1),Wo={class:"font-medium text-lg"},Ho=e("hr",{class:"my-3 mx-0 border-top-1 border-none surface-border"},null,-1),Ro={class:"list-none p-0 m-0 flex-grow-1 px-3"},Uo={class:"flex align-items-center mb-3"},Go=e("h6",{class:"font-bold m-0 p-0"},[e("i",{class:"pi pi-calendar text-2xl mt-1 mr-3"})],-1),Ko={class:"text-lg"},Zo={class:"flex align-items-center mb-3"},Xo=e("h6",{class:"font-bold m-0 p-0"},[e("i",{class:"pi pi-id-card text-2xl mt-1 mr-3"})],-1),Qo={class:"text-lg"},Yo={class:"flex align-items-center mb-3"},el=e("h6",{class:"font-bold m-0 p-0"},[e("i",{class:"pi pi-check-circle text-2xl mt-1 mr-3"})],-1),tl={class:"text-lg"},ol=e("hr",{class:"my-3 mx-0 border-top-1 border-none surface-border"},null,-1),ll={class:"flex pb-3 align-items-center px-3"},sl={class:"font-bold m-0 p-0 mr-2"},nl={key:1,class:"flex align-items-center justify-content-center",style:{height:"60vh"}},al={class:"flex pt-4 justify-content-start"},il="pk.eyJ1Ijoic2lyb2ppZGRpbjc2NzkiLCJhIjoiY2x3OTh5ZThtMDE3dTJrbThmaXFjMHFubyJ9.VB1O3PP2F8aSNjeuhn-ebQ",fl={__name:"Face",setup(cl){Ue("socket");const{t:Y,locale:h}=Ge(),Ie=Ke(),Se=window.location.search;new URLSearchParams(Se);const k=c(0);let o;const ee=c(!0);c();const C=c();c([]),c();const D=c({objects:"",totalPages:"",totalData:""});c([]),c(!1),c();const W=c(),O=c(!1),B=c();let te;c(.1),c(17.5),c(!0),c(!1);const Z=c();c(!0),c(!1);let oe=0;const I=c({img:"standard"}),je=c([{img:"standard"},{img:"satellite-streets-v12"},{img:"satellite-v9"},{img:"navigation-day-v1"},{img:"navigation-night-v1"},{img:"light-v11"},{img:"dark-v11"},{img:"streets-v12"},{img:"outdoors-v12"}]);c({});const g=c(!1);c([{breakpoint:"1024px",numVisible:5},{breakpoint:"960px",numVisible:4},{breakpoint:"768px",numVisible:3},{breakpoint:"560px",numVisible:1}]);let _;const T=c(),E=c(),A=c(),J=c(!0),le=c(),se=c(),Le=c();c([{uz:"Onlayn",oz:"Онлайн",ru:"Онлайн",value:"1"},{uz:"Oflayn",oz:"Офлайн",ru:"Офлайн",value:"0"}]),c(null);const H=c(null),$e=c({}),Ce=c({}),v=c({q:"",limit:20,page:1});async function Be(){const{data:t}=await L.get("/references/regions");le.value=t}async function ne(){const{data:t}=await L.get(`/references/distcity?region=${T.value}`);se.value=t}async function Te(){const{data:t}=await L.get("/edu/refs/type");Le.value=t}w(()=>J.value,async()=>{await N(),M(C.value)}),w(()=>T.value,async()=>{ne(),E.value=null,await N(),M(C.value)}),w(()=>E.value,async()=>{await N(),M(C.value)}),w(()=>A.value,async()=>{await N(),M(C.value)}),w(()=>v.value.page,async()=>{U()},{deep:!0}),w(()=>v.value.q,async()=>{(v.value.q.length>2||v.value.q.length==0)&&U()},{deep:!0});function Ee(t){v.value.page=t.page}const Pe=()=>{$e.value={global:{value:null,matchMode:ke.CONTAINS}},Ce.value={global:{value:null,matchMode:ke.CONTAINS}}},Fe=(t,l)=>{l=="objects"&&l!=="alarmCars"?(R(t.lat,t.lon),M(C.value,t)):R(t.lat,t.lon)},Me=(t,l)=>{l=="objects"&&l!=="alarmCars"?(R(t.lat,t.lon),M(C.value,t)):R(t.lat,t.lon)},R=(t,l)=>{o&&o.flyTo({center:[l,t],zoom:18,speed:5,curve:.8,essential:!0})};w(()=>Ie.isCollapsed,()=>{o&&setTimeout(()=>{o.resize()},400)});const X=c(!1);async function U(){X.value=!0;let t=`/edu/info-list?page=${v.value.page+1}&limit=${v.value.limit}`,l=[];T.value&&l.push(`region=${T.value}`),E.value&&l.push(`distcity=${E.value}`),A.value&&l.push(`object_type=${A.value}`),J.value&&l.push(`camera=${J.value}`),v.value.q&&l.push(`q=${v.value.q}`),l.length>0&&(t+="&"+l.join("&"));const{data:d}=await L.get(t);D.value.objects=d.data,D.value.totalPages=d.totalPages,D.value.totalData=d.totalData,X.value=!1}async function N(){U();let t="/edu/list",l=[];T.value&&l.push(`region=${T.value}`),E.value&&l.push(`distcity=${E.value}`),A.value&&l.push(`object_type=${A.value}`),J.value&&l.push(`camera=${J.value}`),l.length>0&&(t+="?"+l.join("&"));const d=await L.get(t);C.value=d.data}Ze(()=>{Pe()}),Xe(async()=>{await Be(),ne(),Te();const t=async()=>{const l=["https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.js","https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js","https://cdn.jsdelivr.net/npm/threebox-plugin@2.1.1/dist/threebox.min.js","https://cdn.jsdelivr.net/gh/jscastro76/threebox@v.2.2.2/dist/threebox.min.js","http://10.100.9.145/plugins/dist/jquery.js","http://10.100.9.145/plugins/dist/jsPlugin-1.2.0.min.js","http://10.100.9.145/plugins/hls.js","http://10.100.9.145/plugins/dist/polyfill2.js","http://10.100.9.145/plugins/dist/cryptico.min.js","http://10.100.9.145/plugins/dist/uuid.js","http://10.100.9.145/plugins/dist/jquery.cookie.js"];for(const d of l)await new Promise((f,y)=>{const s=document.createElement("script");s.src=d,s.onload=f,s.onerror=()=>y(new Error(`Failed to load script ${d}`)),document.head.appendChild(s)})};w(()=>I.value,()=>{t().then(async()=>{mapboxgl.accessToken=il,oe=0,o=new mapboxgl.Map({container:"map",style:`mapbox://styles/mapbox/${I.value.img}`,center:[64.0202744,41.6384327],zoom:5.5,pitch:0,bearing:oe,antialias:!0});const l=new MapboxGeocoder({accessToken:mapboxgl.accessToken,marker:!1,placeholder:"Search Address",mapboxgl});o.addControl(new mapboxgl.NavigationControl),o.addControl(l,"top-right"),document.querySelector(".mapboxgl-ctrl-geocoder--input").addEventListener("input",d=>{Z.value=d.target.value,Z.value?document.querySelector(".mapboxgl-ctrl-geocoder").style.width="250px":document.querySelector(".mapboxgl-ctrl-geocoder").style.width="35px"}),document.querySelector(".mapboxgl-ctrl-geocoder--button").addEventListener("click",()=>{Z.value="",document.querySelector(".mapboxgl-ctrl-geocoder").style.width="35px"}),o.loadImage(Ye,function(d,f){if(d)throw d;o.addImage("location_green_icon",f)}),te=window.tb=new Threebox(o,o.getCanvas().getContext("webgl"),{defaultLights:!0}),o.on("style.load",()=>{if(I.value.img!=="standard")return;o.style.getFragmentStyle("basemap").options.get("lightPreset");const y="night";let s=document.getElementById(y);s.classList.add("selected"),o.setConfigProperty("basemap","lightPreset",y),document.querySelectorAll(".map-button").forEach(i=>{i.addEventListener("click",()=>{o.setConfigProperty("basemap","lightPreset",i.id),s&&s.classList.remove("selected"),i.classList.add("selected"),s=i})})}),o.on("load",()=>{var i;if(o.setFog(null),I.value.img!=="standard"&&I.value.img!=="satellite-v9"){const S=(i=o.getStyle().layers.find(b=>b.type==="symbol"&&b.layout["text-field"]))==null?void 0:i.id;o.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),o.setTerrain({source:"mapbox-dem",exaggeration:1.5}),o.addLayer({id:"sky",type:"sky",paint:{"sky-type":"atmosphere","sky-atmosphere-sun":[0,0],"sky-atmosphere-sun-intensity":15}}),o.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:10,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.8}},S)}o.addLayer({id:"custom-threebox-model",type:"custom",renderingMode:"3d",onAdd:function(){},render:function(){te.update(),o.getZoom()}}),o.addSource("uzbekistan",{type:"geojson",data:et}),o.addLayer({id:"uzbekistan-boundaries",type:"line",source:"uzbekistan",layout:{},paint:{"line-color":"#000","line-width":2}}),o.addLayer({id:"uzbekistan-fill",type:"fill",source:"uzbekistan",layout:{},paint:{"fill-color":"#EFECDA","fill-opacity":0}}),o.addSource("traffic",{type:"vector",url:"mapbox://mapbox.mapbox-traffic-v1"}),o.addLayer({id:"traffic",type:"line",source:"traffic","source-layer":"traffic",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["match",["get","congestion"],"low","#06D001","moderate","#FF8F00","heavy","#FE0000","severe","#212529","#000000"],"line-width":["interpolate",["linear"],["zoom"],9,1,16,6],"line-opacity":1}});const d=document.createElement("button");d.innerHTML="2D",d.style.fontWeight="800",d.style.color="#000",d.onclick=()=>{o.easeTo({pitch:0,bearing:0})};const f=document.createElement("button");f.innerHTML="3D",f.style.fontWeight="800",f.style.color="#000",f.onclick=()=>{o.easeTo({pitch:60,bearing:0})};const y=document.createElement("button");y.innerHTML="T",y.style.fontWeight="800",y.style.color="#000";let s=!1;if(o.setLayoutProperty("traffic","visibility","none"),y.onclick=()=>{s=!s,o.setLayoutProperty("traffic","visibility",s?"visible":"none")},ee.value){ee.value=!1;class V{onAdd(b){return this._map=b,this._container=document.querySelector(".mapboxgl-ctrl-group"),this._container.appendChild(d),this._container.appendChild(f),this._container.appendChild(y),this.updateButtons(),b.on("pitchend",this.updateButtons.bind(this)),b.on("moveend",this.updateButtons.bind(this)),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map.off("pitchend",this.updateButtons.bind(this)),this._map.off("moveend",this.updateButtons.bind(this)),this._map=void 0}updateButtons(){this._map.getPitch()===0?(d.style.display="none",f.style.display="block"):(d.style.display="block",f.style.display="none")}}o.addControl(new V,"top-right")}}),await N(),M(C.value)}).catch(l=>{console.error("Error loading scripts:",l)})},{deep:!0,immediate:!0})});let F,ae=!0;async function M(t,l){o.getSource("objects")&&(o.removeLayer("clusters"),o.removeLayer("cluster-count"),o.removeLayer("unclustered-point"),o.removeSource("objects")),F&&F.remove();let d=new mapboxgl.LngLatBounds;if(l){let s=t.find(i=>i.id===l.id);if(s)try{const{data:i}=await L.get(`edu/${s.id}`);setTimeout(()=>{F=new mapboxgl.Popup().setLngLat([s.lon,s.lat]).setHTML(`
                                <div class="shadow-2 p-1 border-round">
                                    <div class="flex align-items-center mb-3" style="justify-content: space-between">
                                        <div class="flex align-items-center justify-content-center bg-orange-500 border-round" style="width:2.5rem;height:2rem">
                                            <i class="pi pi-shield text-xl" style="color: #fff"></i>
                                        </div>
                                        <div>
                                            <span style="color: #428eff" class="block font-medium text-xl ml-2">${i.data[0].district[h.value]}</span>
                                        </div>
                                        <div>
                                        </div>
                                    </div>
                                    <div class="text-900 font-medium text-xl">
                                        <img width="100" src="${pe(i.data[0].photo)}"/>
                                    </div>
                                    <span class="text-orange-500 font-medium text-lg mt-2">${i.data[0].school[h.value]}</span>
                                    <div>
                                        <button id="moreInfoButton" class="o-button o-button-success mt-3" type="button">
                                            <i class="pi pi-info-circle mr-2"></i>
                                            ${Y("more_info")}
                                        </button>
                                    </div>
                                </div>
                            `).addTo(o),document.getElementById("moreInfoButton").addEventListener("click",function(){ie(i.data[0].id)})},2400)}catch{setTimeout(()=>{F=new mapboxgl.Popup().setLngLat([s.lon,s.lat]).setHTML(`
                    <div class="shadow-2 p-1 border-round">
                        <div class="text-red-500 font-medium">Failed to load data.</div>
                    </div>
                `).addTo(o)},2400)}}else t.forEach(s=>{d.extend([s.lon,s.lat])}),o.fitBounds(d,{duration:2e3,maxZoom:14});let f;t.map(s=>{f={type:"Feature",geometry:{type:"Point",coordinates:[s.lon,s.lat]},properties:{id:s.id,type:String(s.type),lon:s.lon,lat:s.lat}},t.push(f)});let y;y={type:"FeatureCollection",features:t},o.addSource("objects",{type:"geojson",data:y,cluster:!0,clusterRadius:50}),o.addLayer({id:"clusters",type:"circle",source:"objects",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"rgba(181, 226, 140, 0.8)",100,"rgba(241, 211, 87, 0.8)",750,"rgba(253, 156, 115, 0.8)"],"circle-radius":["step",["get","point_count"],20,100,30,750,40],"circle-stroke-width":1,"circle-stroke-color":"#fff"}}),o.addLayer({id:"cluster-count",type:"symbol",source:"objects",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12,"text-ignore-placement":!0,"text-allow-overlap":!0},paint:{"text-color":"#fff"}}),o.addLayer({id:"unclustered-point",type:"symbol",source:"objects",filter:["!",["has","point_count"]],layout:{"icon-image":["match",["get","type"],"1","type1-marker","2","type2-marker","3","type3-marker","4","type4-marker","5","type5-marker","default-marker"],"icon-size":1,"text-field":"","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-offset":[0,1.25],"text-anchor":"top"}}),ae&&(o.loadImage(ct,function(s,i){if(s)throw s;o.hasImage("default-marker")||o.addImage("default-marker",i)}),o.loadImage(lt,function(s,i){if(s)throw s;o.hasImage("type1-marker")||o.addImage("type1-marker",i)}),o.loadImage(st,function(s,i){if(s)throw s;o.hasImage("type2-marker")||o.addImage("type2-marker",i)}),o.loadImage(nt,function(s,i){if(s)throw s;o.hasImage("type3-marker")||o.addImage("type3-marker",i)}),o.loadImage(at,function(s,i){if(s)throw s;o.hasImage("type4-marker")||o.addImage("type4-marker",i)}),o.loadImage(it,function(s,i){if(s)throw s;o.hasImage("type5-marker")||o.addImage("type5-marker",i)}),o.on("click","clusters",s=>{const i=o.queryRenderedFeatures(s.point,{layers:["clusters"]}),V=i[0].properties.cluster_id;o.getSource("objects").getClusterExpansionZoom(V,(S,b)=>{S||o.easeTo({center:i[0].geometry.coordinates,zoom:b})})}),o.on("click","unclustered-point",async function(s){console.log(s.point),F=new mapboxgl.Popup().setLngLat([JSON.parse(s.features[0].properties.lon),JSON.parse(s.features[0].properties.lat)]).setHTML(`
                <div class="flex justify-content-center py-4">
                    <i class="pi pi-spin pi-spinner text-xl"></i>
                </div>
            `).addTo(o);try{const{data:i}=await L.get(`edu/${s.features[0].properties.id}`);F.setHTML(`
                <div class="shadow-2 p-1 border-round">
                    <div class="flex align-items-center mb-3" style="justify-content: space-between">
                        <div class="flex align-items-center justify-content-center bg-orange-500 border-round" style="width:2.5rem;height:2rem">
                            <i class="pi pi-shield text-xl" style="color: #fff"></i>
                        </div>
                        <div>
                            <span style="color: #428eff" class="block font-medium text-xl ml-2">${i.data[0].district[h.value]}</span>
                        </div>
                        <div>
                        </div>
                    </div>
                    <div class="text-900 font-medium text-xl">
                        <img width="200" height="90" style="object-fit:cover" src="${pe(i.data[0].photo)}"/>
                    </div>
                    <span class="text-orange-500 font-medium text-lg mt-2">${i.data[0].school[h.value]}</span>
                    
                    
                    <div>
                    ${i.data[0].cam_count!="0"?`
                        <button id="openCamera" class="o-button o-button-success mt-3" style="padding: 1rem" type="button">
                            <i class="pi pi-camera"></i>
                        </button>
                    `:""}
                        <button id="moreInfoButton" class="o-button o-button-secondary mt-3" type="button">
                            <i class="pi pi-info-circle mr-2"></i>
                            ${Y("more_info")}
                        </button>
                    </div>
                </div>
            `),document.getElementById("moreInfoButton").addEventListener("click",function(){ie(i.data[0].id)}),document.getElementById("openCamera")&&document.getElementById("openCamera").addEventListener("click",function(){ze(i.data[0].id)})}catch(i){console.error("Error fetching object info:",i),F.setHTML(`
                <div class="shadow-2 p-1 border-round">
                    <div class="text-red-500 font-medium">Failed to load data.</div>
                </div>
            `)}}),o.on("mouseenter","clusters",()=>{o.getCanvas().style.cursor="pointer"}),o.on("mouseleave","clusters",()=>{o.getCanvas().style.cursor=""}),ae=!1)}async function ie(t){try{const{data:l}=await L.get(`edu/info/${t}`);g.value=l,k.value=0}catch(l){console.error(l)}}var ce=0;let z=!1;w(()=>O.value,()=>{O.value||(document.querySelector(".mute").style.display="block",document.querySelector(".unmute").style.display="none",z&&(_.JS_Stop(0),z=!1))}),w(()=>B.value,()=>{var t;(t=B.value)!=null&&t.code&&(K(()=>{document.getElementById("offline_bg").style.display="flex",document.getElementById("offline_bg").innerHTML="",document.getElementById("offline_bg").classList.add("camera_loading"),document.getElementById("playWind").style.display="none",document.querySelector(".mute").style.display="block",document.querySelector(".unmute").style.display="none"}),z?_.JS_Stop(0).then(function(){console.log("stop success"),z=!1,K(de(B.value))},function(){console.log("stop failed")}):K(de(B.value)))});async function ze(t){try{document.getElementById("openCamera").innerHTML='<i class="pi pi-spin pi-spinner text-xl"></i>';const l=await L.get(`/edu/cam-url/${t}`);W.value=l.data,B.value=l.data.camInfo[0],O.value=!0,document.getElementById("openCamera").innerHTML='<i class="pi pi-camera"></i>'}catch{document.getElementById("openCamera").classList.remove("o-button-success"),document.getElementById("openCamera").classList.add("o-button-danger"),document.getElementById("openCamera").innerHTML='<i class="pi pi-times"></i>'}}function de(t){K(()=>{_=new JSPlugin({szId:"playWind",iType:2,iWidth:1110,iHeight:670,iMaxSplit:4,iCurrentSplit:2,szBasePath:"/src",oStyle:{border:"#343434",borderSelect:"transparent",background:"#000 url('/src/assets/online.svg') no-repeat center center;"}}),$(".mute").click(function(l){var d=_.JS_OpenSound(0);if(d==0)console.log("Ушбу камерада овоз бор, уни ёқишни тасдиқлайсизми?"),$(".mute").hide(),$(".unmute").show();else{alert("Ушбу камерада овоз йўқ");return}}),$(".unmute").click(function(l){$(".mute").show(),$(".unmute").hide(),Ve()}),z?_.JS_Stop(0).then(function(){console.log("stop success"),z=!1,ue(1),(t==null?void 0:t.code)==0?(document.getElementById("offline_bg").style.display="none",document.getElementById("playWind").style.display="block",document.getElementById("playWind").style.width="1110px",document.getElementById("playWind").style.height="670px",re(t==null?void 0:t.url,0)):(document.getElementById("offline_bg").style.display="flex",document.getElementById("offline_bg").innerHTML="Kamera offline",document.getElementById("offline_bg").classList.remove("camera_loading"),document.getElementById("playWind").style.display="none")},function(){console.log("stop failed")}):(ue(1),(t==null?void 0:t.code)==0?(document.getElementById("offline_bg").style.display="none",document.getElementById("playWind").style.display="block",document.getElementById("playWind").style.width="1110px",document.getElementById("playWind").style.height="670px",re(t==null?void 0:t.url,0)):(document.getElementById("offline_bg").style.display="flex",document.getElementById("offline_bg").innerHTML="Kamera offline",document.getElementById("offline_bg").classList.remove("camera_loading"),document.getElementById("playWind").style.display="none"))})}function re(t,l){_.JS_Play(t,{playURL:t},l).then(function(){console.log("realplay success"),l==0&&(z=!0)},function(){console.log("realplay failed")})}function ue(t){_.JS_ArrangeWindow(t)}function qe(t){_.JS_CapturePicture(ce,"img",t).then(function(){console.log("CapturePicture success")},function(){console.log("CapturePicture failed")})}function Ve(){_.JS_CloseSound(ce)}function De(){_.JS_FullScreenDisplay(!0)}window.onresize=function(){_==null||_.JS_Resize(1110,670),document.getElementById("playWind").style.width="1110px",document.getElementById("playWind").style.height="670px"};const pe=t=>`http://10.100.26.3:8453/api/v1/pictures/edu_organizations/${t}`,me=t=>`http://10.100.26.3:8453/api/v1/pictures/guard_staffs/${t}`;return(t,l)=>{var ve;const d=m("Image"),f=m("SelectButton"),y=m("v-select"),s=m("InputIcon"),i=m("InputText"),V=m("IconField"),S=m("Column"),b=m("Paginator"),fe=m("DataTable"),Oe=m("Fieldset"),Ae=m("Badge"),Je=m("Dropdown"),Ne=m("FloatLabel"),ge=m("Dialog"),We=m("AccordionTab"),He=m("Accordion"),ye=m("Button"),he=m("StepperPanel"),Re=m("Stepper");return j(),q(we,null,[e("div",dt,[e("div",rt,[e("div",ut,[e("div",pt,[((ve=I.value)==null?void 0:ve.img)=="standard"?(j(),_e(tt,{key:0})):be("",!0),e("div",mt,[r(d,{src:`/demo/images/${I.value.img}.png`,alt:""},null,8,["src"]),r(f,{modelValue:I.value,"onUpdate:modelValue":l[0]||(l[0]=n=>I.value=n),options:je.value},{option:u(n=>[e("div",null,[r(d,{src:`/demo/images/${n.option.img}.png`,alt:""},null,8,["src"]),e("div",ft,a(t.$t(n.option.img)),1)])]),_:1},8,["modelValue","options"])])]),gt,r(Oe,{legend:t.$t("filter"),class:"filter-box map-card",collapsed:!0,toggleable:!0},{default:u(()=>[e("div",yt,[e("div",ht,[e("label",vt,a(t.$t("regions")),1),r(y,{modelValue:T.value,"onUpdate:modelValue":l[1]||(l[1]=n=>T.value=n),options:le.value,label:x(h),reduce:n=>n.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),e("div",_t,[e("label",bt,a(t.$t("districts")),1),r(y,{modelValue:E.value,"onUpdate:modelValue":l[2]||(l[2]=n=>E.value=n),options:se.value,label:x(h),reduce:n=>n.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),e("div",xt,[r(fe,{value:D.value.objects,selection:H.value,"onUpdate:selection":l[5]||(l[5]=n=>H.value=n),loading:X.value,dataKey:"id",selectionMode:"single",metaKeySelection:!1,onRowSelect:l[6]||(l[6]=n=>Fe(H.value,"objects")),onRowUnselect:l[7]||(l[7]=n=>Me(H.value,"objects")),scrollable:"",scrollHeight:"350px",virtualScroll:""},{header:u(()=>[e("div",wt,[r(V,{iconPosition:"left",class:"block mt-2 md:mt-0"},{default:u(()=>[r(s,{class:"pi pi-search"}),r(i,{class:"w-full",modelValue:v.value.q,"onUpdate:modelValue":l[3]||(l[3]=n=>v.value.q=n),modelModifiers:{trim:!0},placeholder:t.$t("search")},null,8,["modelValue","placeholder"])]),_:1})])]),footer:u(()=>[e("div",kt,[r(b,{onPage:Ee,page:v.value.page,"onUpdate:page":l[4]||(l[4]=n=>v.value.page=n),rows:v.value.limit,totalRecords:D.value.totalData,template:"FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink ",currentPageReportTemplate:`{first} - {last} ${t.$t("little_from")} {totalRecords}`},null,8,["page","rows","totalRecords","currentPageReportTemplate"])])]),default:u(()=>[r(S,{headerStyle:"width:14px;"},{body:u(n=>[Q(a(n.data.name[x(h)]),1)]),_:1})]),_:1},8,["value","selection","loading"])])])]),_:1},8,["legend"])])]),It]),r(ge,{visible:O.value,"onUpdate:visible":l[11]||(l[11]=n=>O.value=n),modal:!0,breakpoints:{"960px":"75vw"},style:xe([{width:"60vw"},{"z-index":"1000"}])},{header:u(()=>{var n,p,P;return[e("h3",St,a((p=(n=W.value)==null?void 0:n.object[0])==null?void 0:p.name[x(h)]),1),e("p",jt,a(t.$t("current_camera"))+": "+a((P=B.value)==null?void 0:P.comment),1)]}),default:u(()=>[e("div",null,[Lt,$t,e("div",Ct,[e("div",Bt,[e("div",Tt,[e("button",{class:"o-button o-button-secondary",type:"button",onClick:l[8]||(l[8]=n=>De())},Pt)]),Ft,Mt,e("div",zt,[e("button",{class:"o-button o-button-warning",type:"button",onClick:l[9]||(l[9]=n=>qe("JPEG"))},Vt)])]),e("div",Dt,[e("div",Ot,[e("p",At,a(t.$t("all_cameras"))+":",1),e("b",Jt,a(W.value.camInfo.length),1)]),e("div",Nt,[r(Ne,{class:"w-full"},{default:u(()=>[e("label",Wt,a(t.$t("camera")),1),r(Je,{class:"w-full",inputId:"camera",modelValue:B.value,"onUpdate:modelValue":l[10]||(l[10]=n=>B.value=n),options:W.value.camInfo,optionLabel:"comment",placeholder:t.$t("select")},{value:u(n=>{var p,P;return[(p=n.value)!=null&&p.comment?(j(),q("div",Ht,[e("div",null,a((P=n.value)==null?void 0:P.comment),1)])):(j(),q("span",Rt,a(n.placeholder),1))]}),option:u(n=>[e("div",Ut,[e("div",null,[r(Ae,{class:"mb-1",severity:n.option.code==0?"success":"danger"},null,8,["severity"]),Q(" "+a(n.option.comment),1)])])]),_:1},8,["modelValue","options","placeholder"])]),_:1})])])])])]),_:1},8,["visible"]),r(ge,{header:t.$t("more_info"),visible:g.value,"onUpdate:visible":l[13]||(l[13]=n=>g.value=n),modal:"",breakpoints:{"960px":"75vw"},style:{width:"60vw"}},{default:u(()=>[r(Re,{activeStep:k.value,"onUpdate:activeStep":l[12]||(l[12]=n=>k.value=n)},{default:u(()=>[r(he,null,{header:u(({clickCallback:n})=>[e("div",{style:{cursor:"pointer"},onClick:n,class:"flex align-items-center"},[e("button",Kt,[e("span",{class:G(["border-round border-2 w-3rem h-3rem inline-flex align-items-center justify-content-center",{"bg-primary surface-border":k.value==0,"surface-border":k.value!==0}])},Xt,2)]),e("div",{class:G([{"text-primary surface-border":k.value==0}])},a(t.$t("edu_center")),3)],8,Gt)]),content:u(({nextCallback:n})=>[e("div",null,[e("div",Qt,[e("div",Yt,[e("div",eo,[e("ul",to,[e("li",oo,[e("div",lo,a(t.$t("edu_type"))+":",1),e("div",so,a(g.value.object.type[x(h)]),1)]),e("li",no,[e("div",ao,a(t.$t("district"))+":",1),e("div",io,a(g.value.object.district[x(h)]),1)]),e("li",co,[e("div",ro,a(t.$t("address"))+":",1),e("div",uo,a(g.value.object.address[x(h)]),1)]),e("li",po,[e("div",mo,a(t.$t("edu_center"))+":",1),e("div",fo,a(g.value.object.school[x(h)]),1)]),e("li",go,[e("div",yo,a(t.$t("teachers_count"))+":",1),e("div",ho,a(g.value.object.teachers_count),1)]),e("li",vo,[e("div",_o,a(t.$t("students_count"))+":",1),e("div",bo,a(g.value.object.students_count),1)]),e("li",xo,[e("div",wo,a(t.$t("shifts_count"))+":",1),e("div",ko,a(g.value.object.shifts_count),1)]),e("li",Io,[e("div",So,a(t.$t("guarding_technic_center"))+":",1),e("div",jo,a(g.value.object.tqm[x(h)]=="null"?"":g.value.object.tqm[x(h)]),1)])])])]),e("div",Lo,[e("div",$o,[r(ot,{images:g.value.photos},null,8,["images"])])]),e("div",Co,[r(He,null,{default:u(()=>[r(We,{header:t.$t("staffs")},{default:u(()=>[r(fe,{value:g.value.staff,selectionMode:"single",paginator:!0,rows:5,responsiveLayout:"scroll"},{default:u(()=>[r(S,{field:"name",header:t.$t("fio"),sortable:!0,headerStyle:"min-width:12rem;"},null,8,["header"]),r(S,{field:"position",header:t.$t("position"),headerStyle:"min-width:5rem;"},{body:u(p=>[Q(a(p.data.position[x(h)]),1)]),_:1},8,["header"]),r(S,{field:"phone",header:t.$t("phone"),sortable:!0,headerStyle:"min-width:8rem;"},null,8,["header"])]),_:1},8,["value"])]),_:1},8,["header"])]),_:1})])])]),e("div",Bo,[r(ye,{label:"",icon:"pi pi-arrow-right",iconPos:"right",onClick:n},null,8,["onClick"])])]),_:1}),r(he,null,{header:u(({clickCallback:n})=>[e("div",{style:{cursor:"pointer"},onClick:n,class:"flex align-items-center"},[e("div",{class:G([{"text-primary surface-border":k.value==1}])},a(t.$t("guarding_staffs")),3),e("button",Eo,[e("span",{class:G(["border-round border-2 w-3rem h-3rem inline-flex align-items-center justify-content-center",{"bg-primary surface-border":1<=k.value,"surface-border":1>k.value}])},Fo,2)])],8,To)]),content:u(({prevCallback:n})=>[e("div",null,[g.value.guard_staff?(j(),q("div",Mo,[(j(!0),q(we,null,Qe(g.value.guard_staff,p=>(j(),q("div",{key:p.id,class:"col p-1"},[e("div",zo,[e("div",qo,[e("div",Vo,[p.photo?(j(),_e(d,{key:0,alt:"Image",preview:""},{image:u(()=>[e("img",{src:me(p.photo),alt:"image",height:"240",style:{"border-radius":"10px"}},null,8,Do)]),preview:u(P=>[e("img",{src:me(p.photo),alt:"preview",style:xe(P.style),onClick:P.onClick},null,12,Oo)]),_:2},1024)):be("",!0),e("div",Ao,a(p.lastname)+" "+a(p.firstname)+" "+a(p.surname),1)]),e("div",Jo,[No,e("p",Wo,a(p.phone),1)]),Ho,e("ul",Ro,[e("li",Uo,[Go,e("p",Ko,a(p.birthdate.split("T")[0]),1)]),e("li",Zo,[Xo,e("p",Qo,a(p.pinfl),1)]),e("li",Yo,[el,e("p",tl,a(p.mil_service==0?t.$t("no"):t.$t("yes")),1)])]),ol,e("div",ll,[e("h6",sl,a(t.$t("work_from"))+":",1),e("p",null,a(p.work_from.split("T")[0]),1)])])])]))),128))])):(j(),q("div",nl,[e("h3",null,a(t.$t("no_data")),1)]))]),e("div",al,[r(ye,{label:"",severity:"secondary",icon:"pi pi-arrow-left",onClick:n},null,8,["onClick"])])]),_:1})]),_:1},8,["activeStep"])]),_:1},8,["header","visible"])],64)}}};export{fl as default};
