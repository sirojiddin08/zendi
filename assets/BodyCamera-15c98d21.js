import{m as se,u as oe,r as c,o as ie,a as m,w as de,f,b as V,c as q,g as t,i,n,G as r,t as d,j as $,l as D}from"./index-aae41fd2.js";const ne={class:"grid"},ce={class:"col-12"},re={class:"card"},ue=t("i",{class:"pi pi-upload mr-1"},null,-1),me={class:"grid gap-3 ml-2 py-3"},_e={class:"col-3 p-0",style:{width:"220px"}},ve={for:"region",class:"mb-3"},pe={class:"col-3 p-0",style:{width:"220px"}},fe={for:"dictrict",class:"mb-3"},he={class:"col-3 p-0",style:{width:"180px"}},ye={for:"tqm",class:"mb-3"},be=t("i",{class:"pi pi-plus mr-1"},null,-1),ge={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},$e={class:"m-0"},we={class:"text-center"},Ve=t("span",{class:"p-column-title"},"structure",-1),qe=t("span",{class:"p-column-title"},"tqm",-1),ke=t("span",{class:"p-column-title"},"cam_code",-1),Ce=t("span",{class:"p-column-title"},"comment",-1),De=t("span",{class:"p-column-title"},"created_time",-1),Ie=["onClick"],Ue=t("i",{class:"pi pi-pencil"},null,-1),Ne=[Ue],Te=["onClick"],Be=t("i",{class:"pi pi-trash mr-1"},null,-1),Se=[Be],Pe={class:"field grid"},je={class:"col-6"},Fe={for:"cam_code"},Me=t("span",{style:{color:"#ff5050"}},"*",-1),ze={key:0,class:"p-invalid"},Ge={class:"col-6"},Ee={for:"discity"},Je=t("span",{style:{color:"#ff5050"}},"*",-1),Ke={key:0,class:"p-invalid"},Oe={class:"field grid"},Re={class:"col-6"},Ye={for:"tqm"},Ae=t("span",{style:{color:"#ff5050"}},"*",-1),He={key:0,class:"p-invalid"},Le={class:"col-6"},Qe={for:"comment"},We=t("span",{style:{color:"#ff5050"}},"*",-1),Xe={key:0,class:"p-invalid"},Ze={class:"flex align-items-center justify-content-center"},xe=t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),et={key:0},lt={__name:"BodyCamera",setup(tt){const w=se(),{t:u,locale:y}=oe(),b=c(!1),k=c(!1),s=c({});c(null);const P=c(null),h=c(!1),j=c([]),I=c([]),U=c([]),O=c(),R=c(),N=c(!1),F=c([]);ie(async()=>{await C();const e=await m.get("/references/regions"),l=await m.get("/references/distcity"),_=await m.get("/references/tqm"),p=await m.get("/users/cars"),S=await m.get("/references/camera-types");j.value=await e.data,I.value=await l.data,U.value=await _.data,O.value=p.data,R.value=S.data});const o=c({q:"",limit:10,page:0,region:"",distcity:"",tech_center_id:""});JSON.parse(localStorage.getItem("userData"));async function C(e){var l;try{N.value=!0;let _=`/references/body-cameras?page=${o.value.page+1}&limit=${o.value.limit}`,p=[];((l=o.value.q)==null?void 0:l.length)>2&&p.push(`q=${o.value.q}`),o.value.region&&p.push(`region=${o.value.region}`),o.value.distcity&&p.push(`distcity=${o.value.distcity}`),o.value.tech_center_id&&p.push(`tech_center_id=${o.value.tech_center_id}`),p.length>0&&(_+="&"+p.join("&")),F.value=await m.get(_),N.value=!1}catch{N.value=!1}}function Y(e){o.value.region=e,o.value.distcity="",o.value.tech_center_id="",H(e),M()}function A(e){o.value.distcity=e,o.value.tech_center_id="",M()}async function H(e){const l=await m.get(`/references/distcity?region=${e}`);I.value=await l.data}async function M(e){const l=await m.get(`/references/tqm?region=${o.value.region}&distcity=${o.value.distcity}`);U.value=await l.data}const L=()=>{s.value={comment:"",cam_code:null,structure_id:"",tech_center_id:""},h.value=!1,b.value=!0};de(()=>o.value,async()=>{C()},{deep:!0});const Q=()=>{b.value=!1,h.value=!1},W=async()=>{var e;if(h.value=!0,!(((e=s.comment)==null?void 0:e.length)<3)&&s.value.cam_code&&s.value.structure_id&&s.value.tech_center_id)if(s.value.id)try{await m.put(`/references/body-cameras/${s.value.id}`,s.value),C(s.value.id),w.add({severity:"success",summary:u("status"),detail:u("success"),life:3e3}),b.value=!1,s.value={}}catch{w.add({severity:"error",summary:u("status"),detail:u("error"),life:3e3})}else try{await m.post("/references/body-cameras",s.value),C(),w.add({severity:"success",summary:u("status"),detail:u("success"),life:3e3}),b.value=!1,s.value={}}catch{w.add({severity:"error",summary:u("status"),detail:u("error"),life:3e3})}},X=async e=>{const l=await m.get(`/references/body-cameras/${e.id}`);s.value=l.data,b.value=!0},Z=e=>{s.value.id=e,k.value=!0},x=async()=>{try{await m.delete(`/references/body-cameras/${s.value.id}`),k.value=!1,s.value={},w.add({severity:"success",summary:u("status"),detail:u("success"),life:3e3}),C()}catch{w.add({severity:"error",summary:u("status"),detail:u("error"),life:3e3})}},ee=()=>{P.value.exportCSV()};return(e,l)=>{var E,J;const _=f("v-select"),p=f("Toolbar"),S=f("InputIcon"),z=f("InputText"),te=f("IconField"),g=f("Column"),ae=f("DataTable"),le=f("InputNumber"),T=f("Button"),G=f("Dialog");return V(),q("div",ne,[t("div",ce,[t("div",re,[i(p,{class:"mb-4"},{start:n(()=>[t("button",{class:"o-button o-button-secondary mr-2",onClick:l[0]||(l[0]=a=>ee(a))},[ue,r(" "+d(e.$t("save")),1)]),t("div",me,[t("div",_e,[t("label",ve,d(e.$t("regions")),1),i(_,{"onUpdate:modelValue":[Y,l[1]||(l[1]=a=>o.value.region=a)],id:"region",modelValue:o.value.region,options:j.value,label:$(y),reduce:a=>a.id,placeholder:e.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),t("div",pe,[t("label",fe,d(e.$t("districts")),1),i(_,{"onUpdate:modelValue":[A,l[2]||(l[2]=a=>o.value.distcity=a)],id:"dictrict",modelValue:o.value.distcity,options:I.value,label:$(y),reduce:a=>a.id,placeholder:e.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),t("div",he,[t("label",ye,d(e.$t("tqm")),1),i(_,{id:"tqm",modelValue:o.value.tech_center_id,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.tech_center_id=a),options:U.value,label:$(y),reduce:a=>a.id,placeholder:e.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])])])]),end:n(()=>[t("button",{class:"o-button o-button-success",onClick:L},[be,r(d(e.$t("add")),1)])]),_:1}),i(ae,{ref_key:"dt",ref:P,filters:e.filters,"onUpdate:filters":l[5]||(l[5]=a=>e.filters=a),value:(J=(E=F.value)==null?void 0:E.data)==null?void 0:J.data,paginator:"",rows:10,dataKey:"id",loading:N.value,globalFilterFields:["uz","oz","ru","id"]},{header:n(()=>[t("div",ge,[t("h5",$e,d(e.$t("car_cameras")),1),i(te,{iconPosition:"left",class:"block mt-2 md:mt-0"},{default:n(()=>[i(S,{class:"pi pi-search"}),i(z,{class:"w-full sm:w-auto",modelValue:o.value.q,"onUpdate:modelValue":l[4]||(l[4]=a=>o.value.q=a),modelModifiers:{trim:!0},placeholder:e.$t("search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:n(()=>[t("div",we,d(e.$t("no_data")),1)]),default:n(()=>[i(g,{header:e.$t("â„–"),headerStyle:"width:14px;"},{body:n(a=>[r(d(a.index+1),1)]),_:1},8,["header"]),i(g,{field:"structure",header:e.$t("structure"),sortable:!0},{body:n(a=>[Ve,r(" "+d(a.data.structure[$(y)]),1)]),_:1},8,["header"]),i(g,{field:"tqm",header:e.$t("tqm"),sortable:!1},{body:n(a=>[qe,r(" "+d(a.data.tqm[$(y)]),1)]),_:1},8,["header"]),i(g,{field:"cam_code",header:e.$t("cam_code"),sortable:!0},{body:n(a=>[ke,r(" "+d(a.data.cam_code),1)]),_:1},8,["header"]),i(g,{field:"comment",header:e.$t("comment"),sortable:!0},{body:n(a=>[Ce,r(" "+d(a.data.comment),1)]),_:1},8,["header"]),i(g,{field:"created_time",header:e.$t("created_time"),sortable:!0},{body:n(a=>[De,r(" "+d(a.data.created_time),1)]),_:1},8,["header"]),i(g,{header:e.$t("actions"),headerStyle:"min-width:10rem;"},{body:n(a=>[t("button",{class:"o-button o-button-warning mr-2",onClick:B=>X(a.data)},Ne,8,Ie),t("button",{class:"o-button o-button-danger",onClick:B=>Z(a.data.id)},Se,8,Te)]),_:1},8,["header"])]),_:1},8,["filters","value","loading"]),i(G,{visible:b.value,"onUpdate:visible":l[10]||(l[10]=a=>b.value=a),style:{width:"750px"},header:s.value.id?e.$t("edit"):e.$t("add"),modal:!0,class:"p-fluid"},{footer:n(()=>[i(T,{label:e.$t("cancel"),icon:"pi pi-times",class:"text-red-400",text:"",onClick:Q},null,8,["label"]),i(T,{label:e.$t("save"),icon:"pi pi-check",text:"",onClick:W},null,8,["label"])]),default:n(()=>{var a,B,K;return[t("div",Pe,[t("div",je,[t("label",Fe,[r(d(e.$t("cam_code")),1),Me]),i(le,{id:"cam_code",modelValue:s.value.cam_code,"onUpdate:modelValue":l[6]||(l[6]=v=>s.value.cam_code=v),modelModifiers:{trim:!0},placeholder:e.$t("select"),required:"true",invalid:h.value&&!((a=s.value.cam_code)!=null&&a.length),inputId:"withoutgrouping",useGrouping:!1,fluid:""},null,8,["modelValue","placeholder","invalid"]),h.value&&!s.value.cam_code?(V(),q("small",ze,d(e.$t("field_required")),1)):D("",!0)]),t("div",Ge,[t("label",Ee,[r(d(e.$t("districts")),1),Je]),i(_,{id:"discity",modelValue:s.value.structure_id,"onUpdate:modelValue":l[7]||(l[7]=v=>s.value.structure_id=v),options:I.value,label:$(y),reduce:v=>v.id,placeholder:e.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"]),h.value&&!s.value.structure_id?(V(),q("small",Ke,d(e.$t("field_required")),1)):D("",!0)])]),t("div",Oe,[t("div",Re,[t("label",Ye,[r(d(e.$t("tqm")),1),Ae]),i(_,{id:"tqm",modelValue:s.value.tech_center_id,"onUpdate:modelValue":l[8]||(l[8]=v=>s.value.tech_center_id=v),options:U.value,label:$(y),reduce:v=>v.id,placeholder:e.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"]),h.value&&!s.value.tech_center_id?(V(),q("small",He,d(e.$t("field_required")),1)):D("",!0)]),t("div",Le,[t("label",Qe,[r(d(e.$t("comment")),1),We]),i(z,{id:"comment",modelValue:s.value.comment,"onUpdate:modelValue":l[9]||(l[9]=v=>s.value.comment=v),modelModifiers:{trim:!0},required:"true",invalid:h.value&&((B=s.value.comment)==null?void 0:B.length)<3},null,8,["modelValue","invalid"]),h.value&&((K=s.value.comment)==null?void 0:K.length)<3?(V(),q("small",Xe,d(e.$t("min_length"))+" 3",1)):D("",!0)])])]}),_:1},8,["visible","header"]),i(G,{visible:k.value,"onUpdate:visible":l[12]||(l[12]=a=>k.value=a),style:{width:"450px"},header:e.$t("confirmation"),modal:!0},{footer:n(()=>[i(T,{label:"No",icon:"pi pi-times",text:"",onClick:l[11]||(l[11]=a=>k.value=!1)}),i(T,{label:"Yes",icon:"pi pi-check",text:"",onClick:x})]),default:n(()=>[t("div",Ze,[xe,s.value?(V(),q("span",et,[r(d(e.$t("are_you_sure_to_delete_this_item"))+" ",1),t("b",null,d(s.value.name),1)])):D("",!0)])]),_:1},8,["visible","header"])])])])}}};export{lt as default};
