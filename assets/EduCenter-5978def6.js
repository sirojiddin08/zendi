import{A as Ge,u as Ke,B as Ze,r as d,w,C as Xe,o as Qe,f as m,b as S,c as q,g as e,k as be,l as xe,i as r,n as u,v as we,F as ke,a as j,E as Ie,t as a,j as x,G as Q,H as G,h as Ye,I as K}from"./index-aae41fd2.js";import{l as et,u as tt,T as ot}from"./2-61298274.js";import{_ as lt,k as st,s as nt,c as at,u as it,a as dt}from"./uni-6eec2ede.js";import{b as ct}from"./bridge-820ebe1a.js";import"./index-c3a3a22d.js";const rt={class:"grid mapSection"},ut={class:"col-12"},pt={class:"card p-1",style:{position:"relative",overflow:"hidden"}},mt={class:"layer-cog"},ft={class:"layers"},gt={class:"text-xs layer-name"},yt=e("div",{id:"map",class:"p-1",style:{height:"88vh",position:"relative"}},null,-1),ht={class:"grid p-0 m-0",style:{width:"300px"}},vt={class:"col-8 py-2"},_t={for:"edu_type"},bt={class:"col-4"},xt={for:"objects"},wt={class:"col-12 py-2"},kt={for:"regions"},It={class:"col-12 py-2"},St={for:"districts"},jt={class:"col-12 py-2"},$t={class:"p-0"},Lt={class:"p-0"},Ct={class:"mb-0 pb-0"},Bt={class:"font-bold whitespace-nowrap mb-0 pb-0 text-2xl"},Tt=e("div",{id:"playWind",style:{width:"1110px",height:"670px",display:"none"}},null,-1),Et=e("div",{class:"rounded",id:"offline_bg"},[e("span",null,"Kamera offline!")],-1),Pt={class:"items m-2 mt-6 flex"},Mt={class:"grid",style:{width:"180px","margin-left":"-0.4rem"}},zt={class:"col-4 p-0"},Ft=e("i",{class:"pi pi-window-maximize"},null,-1),Vt=[Ft],qt=e("div",{class:"col-4 p-0 unmute",style:{display:"none"}},[e("button",{class:"o-button o-button-success",type:"button"},[e("i",{class:"pi pi-volume-up"})])],-1),Dt=e("div",{class:"col-4 p-0 mute"},[e("button",{class:"o-button o-button-danger",type:"button"},[e("i",{class:"pi pi-volume-off"})])],-1),Ot={class:"col-4 p-0"},Ut=e("i",{class:"pi pi-camera"},null,-1),At=[Ut],Jt={class:"grid w-full",style:{"margin-left":"30px","font-size":"18px"}},Nt={class:"xl:col-9 md:col-6 p-0 mt-1 pl-2"},Wt={style:{display:"inline"}},Ht={class:"ml-2"},Rt={class:"xl:col-3 md:col-6 p-0"},Gt={for:"camera"},Kt={key:0,class:"flex items-center"},Zt={key:1},Xt={class:"flex items-center"},Qt=["onClick"],Yt={class:"bg-transparent border-none inline-flex flex-column gap-2"},eo=e("i",{class:"pi pi-building text-900 text-2xl"},null,-1),to=[eo],oo={class:"grid grid-nogutter text-800"},lo={class:"col-12 md:col-5 text-center md:text-left flex"},so={class:"",style:{width:"100%"}},no={class:"list-none p-0 m-0",style:{width:"100%"}},ao={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},io={class:"text-500 w-6 md:w-4 font-medium"},co={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},ro={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},uo={class:"text-500 w-6 md:w-4 font-medium"},po={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},mo={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},fo={class:"text-500 w-6 md:w-4 font-medium"},go={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},yo={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},ho={class:"text-500 w-6 md:w-4 font-medium"},vo={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},_o={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},bo={class:"text-500 w-6 md:w-4 font-medium"},xo={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},wo={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},ko={class:"text-500 w-6 md:w-4 font-medium"},Io={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},So={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},jo={class:"text-500 w-6 md:w-4 font-medium"},$o={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},Lo={class:"flex align-items-center py-4 px-2 border-top-1 surface-border flex-wrap"},Co={class:"text-500 w-6 md:w-4 font-medium"},Bo={class:"text-color w-full md:w-8 md:flex-order-0 flex-order-1"},To={class:"col-12 md:col-7"},Eo={class:"flex align-items-center justify-content-center flex-column"},Po={class:"col-12 mt-3"},Mo={class:"flex pt-4 justify-content-end"},zo=["onClick"],Fo={class:"bg-transparent border-none inline-flex flex-column gap-2"},Vo=e("i",{class:"pi pi-users text-900 text-2xl"},null,-1),qo=[Vo],Do={key:0,class:"grid p-2"},Oo={class:"h-full"},Uo={class:"shadow-2 p-0 h-full flex flex-column card",style:{"border-radius":"6px"}},Ao={class:"mb-2 flex align-items-center justify-content-center header_img",style:{height:"300px","flex-direction":"column"}},Jo=["src"],No=["src","onClick"],Wo={style:{width:"200px"},class:"text-center mt-2 text-lg"},Ho={class:"flex pt-3 align-items-center px-3"},Ro=e("h6",{class:"font-bold m-0 p-0"},[e("i",{class:"pi pi-phone text-2xl mt-1 mr-3"})],-1),Go={class:"font-medium text-lg"},Ko=e("hr",{class:"my-3 mx-0 border-top-1 border-none surface-border"},null,-1),Zo={class:"list-none p-0 m-0 flex-grow-1 px-3"},Xo={class:"flex align-items-center mb-3"},Qo=e("h6",{class:"font-bold m-0 p-0"},[e("i",{class:"pi pi-calendar text-2xl mt-1 mr-3"})],-1),Yo={class:"text-lg"},el={class:"flex align-items-center mb-3"},tl=e("h6",{class:"font-bold m-0 p-0"},[e("i",{class:"pi pi-id-card text-2xl mt-1 mr-3"})],-1),ol={class:"text-lg"},ll={class:"flex align-items-center mb-3"},sl=e("h6",{class:"font-bold m-0 p-0"},[e("i",{class:"pi pi-check-circle text-2xl mt-1 mr-3"})],-1),nl={class:"text-lg"},al=e("hr",{class:"my-3 mx-0 border-top-1 border-none surface-border"},null,-1),il={class:"flex pb-3 align-items-center px-3"},dl={class:"font-bold m-0 p-0 mr-2"},cl={key:1,class:"flex align-items-center justify-content-center",style:{height:"60vh"}},rl={class:"flex pt-4 justify-content-start"},ul="pk.eyJ1Ijoic2lyb2ppZGRpbjc2NzkiLCJhIjoiY2x3OTh5ZThtMDE3dTJrbThmaXFjMHFubyJ9.VB1O3PP2F8aSNjeuhn-ebQ",vl={__name:"EduCenter",setup(pl){Ge("socket");const{t:Y,locale:y}=Ke(),Se=Ze(),je=window.location.search;new URLSearchParams(je);const k=d(0);let l;const ee=d(!0);d();const L=d();d([]),d();const U=d({objects:"",totalPages:"",totalData:""});d([]),d(!1),d();const N=d(),A=d(!1),C=d();let te;d(.1),d(17.5),d(!0),d(!1);const Z=d();d(!0),d(!1);let oe=0;const I=d({img:"standard"}),$e=d([{img:"standard"},{img:"satellite-streets-v12"},{img:"satellite-v9"},{img:"navigation-day-v1"},{img:"navigation-night-v1"},{img:"light-v11"},{img:"dark-v11"},{img:"streets-v12"},{img:"outdoors-v12"}]);d({});const h=d(!1);d([{breakpoint:"1024px",numVisible:5},{breakpoint:"960px",numVisible:4},{breakpoint:"768px",numVisible:3},{breakpoint:"560px",numVisible:1}]);let b;const B=d(),T=d(),P=d(),M=d(!1),le=d(),se=d(),ne=d();d([{uz:"Onlayn",oz:"Онлайн",ru:"Онлайн",value:"1"},{uz:"Oflayn",oz:"Офлайн",ru:"Офлайн",value:"0"}]),d(null);const W=d(null),Le=d({}),Ce=d({}),v=d({q:"",limit:20,page:1});async function Be(){const{data:t}=await j.get("/references/regions");le.value=t}async function ae(){const{data:t}=await j.get(`/references/distcity?region=${B.value}`);se.value=t}async function Te(){const{data:t}=await j.get("/edu/refs/type");ne.value=t}w(()=>M.value,async()=>{await J(),F(L.value)}),w(()=>B.value,async()=>{ae(),T.value=null,await J(),F(L.value)}),w(()=>T.value,async()=>{await J(),F(L.value)}),w(()=>P.value,async()=>{await J(),F(L.value)}),w(()=>v.value.page,async()=>{R()},{deep:!0}),w(()=>v.value.q,async()=>{(v.value.q.length>2||v.value.q.length==0)&&R()},{deep:!0});function Ee(t){v.value.page=t.page}const Pe=()=>{Le.value={global:{value:null,matchMode:Ie.CONTAINS}},Ce.value={global:{value:null,matchMode:Ie.CONTAINS}}},Me=(t,o)=>{o=="objects"&&o!=="alarmCars"?(H(t.lat,t.lon),F(L.value,t)):H(t.lat,t.lon)},ze=(t,o)=>{o=="objects"&&o!=="alarmCars"?(H(t.lat,t.lon),F(L.value,t)):H(t.lat,t.lon)},H=(t,o)=>{l&&l.flyTo({center:[o,t],zoom:18,speed:5,curve:.8,essential:!0})};w(()=>Se.isCollapsed,()=>{l&&setTimeout(()=>{l.resize()},400)});const X=d(!1);async function R(){X.value=!0;let t=`/edu/info-list?page=${v.value.page+1}&limit=${v.value.limit}`,o=[];B.value&&o.push(`region=${B.value}`),T.value&&o.push(`distcity=${T.value}`),P.value&&o.push(`object_type=${P.value}`),M.value&&o.push(`camera=${M.value}`),v.value.q&&o.push(`q=${v.value.q}`),o.length>0&&(t+="&"+o.join("&"));const{data:c}=await j.get(t);U.value.objects=c.data,U.value.totalPages=c.totalPages,U.value.totalData=c.totalData,X.value=!1}async function J(){R();let t="/edu/list",o=[];B.value&&o.push(`region=${B.value}`),T.value&&o.push(`distcity=${T.value}`),P.value&&o.push(`object_type=${P.value}`),M.value&&o.push(`camera=${M.value}`),o.length>0&&(t+="?"+o.join("&"));const c=await j.get(t);L.value=c.data}Xe(()=>{Pe()}),Qe(async()=>{await Be(),ae(),Te();const t=async()=>{const o=["https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.js","https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js","https://cdn.jsdelivr.net/npm/threebox-plugin@2.1.1/dist/threebox.min.js","https://cdn.jsdelivr.net/gh/jscastro76/threebox@v.2.2.2/dist/threebox.min.js","http://10.100.9.145/plugins/dist/jquery.js","http://10.100.9.145/plugins/dist/jsPlugin-1.2.0.min.js","http://10.100.9.145/plugins/hls.js","http://10.100.9.145/plugins/dist/polyfill2.js","http://10.100.9.145/plugins/dist/cryptico.min.js","http://10.100.9.145/plugins/dist/uuid.js","http://10.100.9.145/plugins/dist/jquery.cookie.js"];for(const c of o)await new Promise((f,g)=>{const s=document.createElement("script");s.src=c,s.onload=f,s.onerror=()=>g(new Error(`Failed to load script ${c}`)),document.head.appendChild(s)})};w(()=>I.value,()=>{t().then(async()=>{mapboxgl.accessToken=ul,oe=0,l=new mapboxgl.Map({container:"map",style:`mapbox://styles/mapbox/${I.value.img}`,center:[64.0202744,41.6384327],zoom:5.5,pitch:0,bearing:oe,antialias:!0});const o=new MapboxGeocoder({accessToken:mapboxgl.accessToken,marker:!1,placeholder:"Search Address",mapboxgl});l.addControl(new mapboxgl.NavigationControl),l.addControl(o,"top-right"),document.querySelector(".mapboxgl-ctrl-geocoder--input").addEventListener("input",c=>{Z.value=c.target.value,Z.value?document.querySelector(".mapboxgl-ctrl-geocoder").style.width="250px":document.querySelector(".mapboxgl-ctrl-geocoder").style.width="35px"}),document.querySelector(".mapboxgl-ctrl-geocoder--button").addEventListener("click",()=>{Z.value="",document.querySelector(".mapboxgl-ctrl-geocoder").style.width="35px"}),l.loadImage(et,function(c,f){if(c)throw c;l.addImage("location_green_icon",f)}),te=window.tb=new Threebox(l,l.getCanvas().getContext("webgl"),{defaultLights:!0}),l.on("style.load",()=>{if(I.value.img!=="standard")return;l.style.getFragmentStyle("basemap").options.get("lightPreset");const g="day";let s=document.getElementById(g);s.classList.add("selected"),l.setConfigProperty("basemap","lightPreset",g),document.querySelectorAll(".map-button").forEach(i=>{i.addEventListener("click",()=>{l.setConfigProperty("basemap","lightPreset",i.id),s&&s.classList.remove("selected"),i.classList.add("selected"),s=i})})}),l.on("load",()=>{var i;if(l.setFog(null),I.value.img!=="standard"&&I.value.img!=="satellite-v9"){const O=(i=l.getStyle().layers.find(_=>_.type==="symbol"&&_.layout["text-field"]))==null?void 0:i.id;l.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),l.setTerrain({source:"mapbox-dem",exaggeration:1.5}),l.addLayer({id:"sky",type:"sky",paint:{"sky-type":"atmosphere","sky-atmosphere-sun":[0,0],"sky-atmosphere-sun-intensity":15}}),l.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:10,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.8}},O)}l.addLayer({id:"custom-threebox-model",type:"custom",renderingMode:"3d",onAdd:function(){},render:function(){te.update(),l.getZoom()}}),l.addSource("uzbekistan",{type:"geojson",data:tt}),l.addLayer({id:"uzbekistan-boundaries",type:"line",source:"uzbekistan",layout:{},paint:{"line-color":"#000","line-width":2}}),l.addLayer({id:"uzbekistan-fill",type:"fill",source:"uzbekistan",layout:{},paint:{"fill-color":"#EFECDA","fill-opacity":0}}),l.addSource("traffic",{type:"vector",url:"mapbox://mapbox.mapbox-traffic-v1"}),l.addLayer({id:"traffic",type:"line",source:"traffic","source-layer":"traffic",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["match",["get","congestion"],"low","#06D001","moderate","#FF8F00","heavy","#FE0000","severe","#212529","#000000"],"line-width":["interpolate",["linear"],["zoom"],9,1,16,6],"line-opacity":1}});const c=document.createElement("button");c.innerHTML="2D",c.style.fontWeight="800",c.style.color="#000",c.onclick=()=>{l.easeTo({pitch:0,bearing:0})};const f=document.createElement("button");f.innerHTML="3D",f.style.fontWeight="800",f.style.color="#000",f.onclick=()=>{l.easeTo({pitch:60,bearing:0})};const g=document.createElement("button");g.innerHTML="T",g.style.fontWeight="800",g.style.color="#000";let s=!1;if(l.setLayoutProperty("traffic","visibility","none"),g.onclick=()=>{s=!s,l.setLayoutProperty("traffic","visibility",s?"visible":"none")},ee.value){ee.value=!1;class D{onAdd(_){return this._map=_,this._container=document.querySelector(".mapboxgl-ctrl-group"),this._container.appendChild(c),this._container.appendChild(f),this._container.appendChild(g),this.updateButtons(),_.on("pitchend",this.updateButtons.bind(this)),_.on("moveend",this.updateButtons.bind(this)),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map.off("pitchend",this.updateButtons.bind(this)),this._map.off("moveend",this.updateButtons.bind(this)),this._map=void 0}updateButtons(){this._map.getPitch()===0?(c.style.display="none",f.style.display="block"):(c.style.display="block",f.style.display="none")}}l.addControl(new D,"top-right")}}),await J(),F(L.value)}).catch(o=>{console.error("Error loading scripts:",o)})},{deep:!0,immediate:!0})});let z,ie=!0;async function F(t,o){l.getSource("objects")&&(l.removeLayer("clusters"),l.removeLayer("cluster-count"),l.removeLayer("unclustered-point"),l.removeSource("objects")),z&&z.remove();let c=new mapboxgl.LngLatBounds;if(o){let s=t.find(i=>i.id===o.id);if(s)try{const{data:i}=await j.get(`edu/${s.id}`);setTimeout(()=>{z=new mapboxgl.Popup().setLngLat([s.lon,s.lat]).setHTML(`
                                <div class="shadow-2 p-1 border-round">
                                    <div class="flex align-items-center mb-3" style="justify-content: space-between">
                                        <div class="flex align-items-center justify-content-center bg-orange-500 border-round" style="width:2.5rem;height:2rem">
                                            <i class="pi pi-shield text-xl" style="color: #fff"></i>
                                        </div>
                                        <div>
                                            <span style="color: #428eff" class="block font-medium text-xl ml-2">${i.data[0].district[y.value]}</span>
                                        </div>
                                        <div>
                                        </div>
                                    </div>
                                    <div class="text-900 font-medium text-xl">
                                        <img width="100" src="${me(i.data[0].photo)}"/>
                                    </div>
                                    <span class="text-orange-500 font-medium text-lg mt-2">${i.data[0].school[y.value]}</span>
                                    <div>
                                        <button id="moreInfoButton" class="o-button o-button-success mt-3" type="button">
                                            <i class="pi pi-info-circle mr-2"></i>
                                            ${Y("more_info")}
                                        </button>
                                    </div>
                                </div>
                            `).addTo(l),document.getElementById("moreInfoButton").addEventListener("click",function(){de(i.data[0].id)})},2400)}catch{setTimeout(()=>{z=new mapboxgl.Popup().setLngLat([s.lon,s.lat]).setHTML(`
                    <div class="shadow-2 p-1 border-round">
                        <div class="text-red-500 font-medium">Failed to load data.</div>
                    </div>
                `).addTo(l)},2400)}}else t.forEach(s=>{c.extend([s.lon,s.lat])}),l.fitBounds(c,{duration:2e3,maxZoom:14});let f;t.map(s=>{f={type:"Feature",geometry:{type:"Point",coordinates:[s.lon,s.lat]},properties:{id:s.id,type:String(s.type),lon:s.lon,lat:s.lat}},t.push(f)});let g;g={type:"FeatureCollection",features:t},l.addSource("objects",{type:"geojson",data:g,cluster:!0,clusterRadius:50}),l.addLayer({id:"clusters",type:"circle",source:"objects",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"rgba(181, 226, 140, 0.8)",100,"rgba(241, 211, 87, 0.8)",750,"rgba(253, 156, 115, 0.8)"],"circle-radius":["step",["get","point_count"],20,100,30,750,40],"circle-stroke-width":1,"circle-stroke-color":"#fff"}}),l.addLayer({id:"cluster-count",type:"symbol",source:"objects",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12,"text-ignore-placement":!0,"text-allow-overlap":!0},paint:{"text-color":"#fff"}}),l.addLayer({id:"unclustered-point",type:"symbol",source:"objects",filter:["!",["has","point_count"]],layout:{"icon-image":["match",["get","type"],"1","type1-marker","2","type2-marker","3","type3-marker","4","type4-marker","5","type5-marker","default-marker"],"icon-size":1,"text-field":"","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-offset":[0,1.25],"text-anchor":"top"}}),ie&&(l.loadImage(ct,function(s,i){if(s)throw s;l.hasImage("default-marker")||l.addImage("default-marker",i)}),l.loadImage(st,function(s,i){if(s)throw s;l.hasImage("type1-marker")||l.addImage("type1-marker",i)}),l.loadImage(nt,function(s,i){if(s)throw s;l.hasImage("type2-marker")||l.addImage("type2-marker",i)}),l.loadImage(at,function(s,i){if(s)throw s;l.hasImage("type3-marker")||l.addImage("type3-marker",i)}),l.loadImage(it,function(s,i){if(s)throw s;l.hasImage("type4-marker")||l.addImage("type4-marker",i)}),l.loadImage(dt,function(s,i){if(s)throw s;l.hasImage("type5-marker")||l.addImage("type5-marker",i)}),l.on("click","clusters",s=>{const i=l.queryRenderedFeatures(s.point,{layers:["clusters"]}),D=i[0].properties.cluster_id;l.getSource("objects").getClusterExpansionZoom(D,(O,_)=>{O||l.easeTo({center:i[0].geometry.coordinates,zoom:_})})}),l.on("click","unclustered-point",async function(s){console.log(s.point),z=new mapboxgl.Popup().setLngLat([JSON.parse(s.features[0].properties.lon),JSON.parse(s.features[0].properties.lat)]).setHTML(`
                <div class="flex justify-content-center py-4">
                    <i class="pi pi-spin pi-spinner text-xl"></i>
                </div>
            `).addTo(l);try{const{data:i}=await j.get(`edu/${s.features[0].properties.id}`);z.setHTML(`
                <div class="shadow-2 p-1 border-round">
                    <div class="flex align-items-center mb-3" style="justify-content: space-between">
                        <div class="flex align-items-center justify-content-center bg-orange-500 border-round" style="width:2.5rem;height:2rem">
                            <i class="pi pi-shield text-xl" style="color: #fff"></i>
                        </div>
                        <div>
                            <span style="color: #428eff" class="block font-medium text-xl ml-2">${i.data[0].district[y.value]}</span>
                        </div>
                        <div>
                        </div>
                    </div>
                    <div class="text-900 font-medium text-xl">
                        <img width="200" height="90" style="object-fit:cover" src="${me(i.data[0].photo)}"/>
                    </div>
                    <span class="text-orange-500 font-medium text-lg mt-2">${i.data[0].school[y.value]}</span>
                    
                    
                    <div>
                    ${i.data[0].cam_count!="0"?`
                        <button id="openCamera" class="o-button o-button-success mt-3" style="padding: 1rem" type="button">
                            <i class="pi pi-camera"></i>
                        </button>
                    `:""}
                        <button id="moreInfoButton" class="o-button o-button-secondary mt-3" type="button">
                            <i class="pi pi-info-circle mr-2"></i>
                            ${Y("more_info")}
                        </button>
                    </div>
                </div>
            `),document.getElementById("moreInfoButton").addEventListener("click",function(){de(i.data[0].id)}),document.getElementById("openCamera")&&document.getElementById("openCamera").addEventListener("click",function(){Fe(i.data[0].id)})}catch(i){console.error("Error fetching object info:",i),z.setHTML(`
                <div class="shadow-2 p-1 border-round">
                    <div class="text-red-500 font-medium">Failed to load data.</div>
                </div>
            `)}}),l.on("mouseenter","clusters",()=>{l.getCanvas().style.cursor="pointer"}),l.on("mouseleave","clusters",()=>{l.getCanvas().style.cursor=""}),ie=!1)}async function de(t){try{const{data:o}=await j.get(`edu/info/${t}`);h.value=o,k.value=0}catch(o){console.error(o)}}var ce=0;let V=!1;w(()=>A.value,()=>{A.value||(document.querySelector(".mute").style.display="block",document.querySelector(".unmute").style.display="none",V&&(b.JS_Stop(0),V=!1))}),w(()=>C.value,()=>{var t;(t=C.value)!=null&&t.code&&(K(()=>{document.getElementById("offline_bg").style.display="flex",document.getElementById("offline_bg").innerHTML="",document.getElementById("offline_bg").classList.add("camera_loading"),document.getElementById("playWind").style.display="none",document.querySelector(".mute").style.display="block",document.querySelector(".unmute").style.display="none"}),V?b.JS_Stop(0).then(function(){console.log("stop success"),V=!1,K(re(C.value))},function(){console.log("stop failed")}):K(re(C.value)))});async function Fe(t){try{document.getElementById("openCamera").innerHTML='<i class="pi pi-spin pi-spinner text-xl"></i>';const o=await j.get(`/edu/cam-url/${t}`);N.value=o.data,C.value=o.data.camInfo[0],A.value=!0,document.getElementById("openCamera").innerHTML='<i class="pi pi-camera"></i>'}catch{document.getElementById("openCamera").classList.remove("o-button-success"),document.getElementById("openCamera").classList.add("o-button-danger"),document.getElementById("openCamera").innerHTML='<i class="pi pi-times"></i>'}}function re(t){K(()=>{b=new JSPlugin({szId:"playWind",iType:2,iWidth:1110,iHeight:670,iMaxSplit:4,iCurrentSplit:2,szBasePath:"/src",oStyle:{border:"#343434",borderSelect:"transparent",background:"#000 url('/src/assets/online.svg') no-repeat center center;"}}),$(".mute").click(function(o){var c=b.JS_OpenSound(0);if(c==0)console.log("Ушбу камерада овоз бор, уни ёқишни тасдиқлайсизми?"),$(".mute").hide(),$(".unmute").show();else{alert("Ушбу камерада овоз йўқ");return}}),$(".unmute").click(function(o){$(".mute").show(),$(".unmute").hide(),qe()}),V?b.JS_Stop(0).then(function(){console.log("stop success"),V=!1,pe(1),(t==null?void 0:t.code)==0?(document.getElementById("offline_bg").style.display="none",document.getElementById("playWind").style.display="block",document.getElementById("playWind").style.width="1110px",document.getElementById("playWind").style.height="670px",ue(t==null?void 0:t.url,0)):(document.getElementById("offline_bg").style.display="flex",document.getElementById("offline_bg").innerHTML="Kamera offline",document.getElementById("offline_bg").classList.remove("camera_loading"),document.getElementById("playWind").style.display="none")},function(){console.log("stop failed")}):(pe(1),(t==null?void 0:t.code)==0?(document.getElementById("offline_bg").style.display="none",document.getElementById("playWind").style.display="block",document.getElementById("playWind").style.width="1110px",document.getElementById("playWind").style.height="670px",ue(t==null?void 0:t.url,0)):(document.getElementById("offline_bg").style.display="flex",document.getElementById("offline_bg").innerHTML="Kamera offline",document.getElementById("offline_bg").classList.remove("camera_loading"),document.getElementById("playWind").style.display="none"))})}function ue(t,o){b.JS_Play(t,{playURL:t},o).then(function(){console.log("realplay success"),o==0&&(V=!0)},function(){console.log("realplay failed")})}function pe(t){b.JS_ArrangeWindow(t)}function Ve(t){b.JS_CapturePicture(ce,"img",t).then(function(){console.log("CapturePicture success")},function(){console.log("CapturePicture failed")})}function qe(){b.JS_CloseSound(ce)}function De(){b.JS_FullScreenDisplay(!0)}window.onresize=function(){b==null||b.JS_Resize(1110,670),document.getElementById("playWind").style.width="1110px",document.getElementById("playWind").style.height="670px"};const me=t=>`http://10.100.26.3:8453/api/v1/pictures/edu_organizations/${t}`,fe=t=>`http://10.100.26.3:8453/api/v1/pictures/guard_staffs/${t}`;return(t,o)=>{var _e;const c=m("Image"),f=m("SelectButton"),g=m("v-select"),s=m("InputSwitch"),i=m("InputIcon"),D=m("InputText"),O=m("IconField"),_=m("Column"),Oe=m("Paginator"),ge=m("DataTable"),Ue=m("Fieldset"),Ae=m("Badge"),Je=m("Dropdown"),Ne=m("FloatLabel"),ye=m("Dialog"),We=m("AccordionTab"),He=m("Accordion"),he=m("Button"),ve=m("StepperPanel"),Re=m("Stepper");return S(),q(ke,null,[e("div",rt,[e("div",ut,[e("div",pt,[e("div",mt,[((_e=I.value)==null?void 0:_e.img)=="standard"?(S(),be(ot,{key:0})):xe("",!0),e("div",ft,[r(c,{src:`/demo/images/${I.value.img}.png`,alt:""},null,8,["src"]),r(f,{modelValue:I.value,"onUpdate:modelValue":o[0]||(o[0]=n=>I.value=n),options:$e.value},{option:u(n=>[e("div",null,[r(c,{src:`/demo/images/${n.option.img}.png`,alt:""},null,8,["src"]),e("div",gt,a(t.$t(n.option.img)),1)])]),_:1},8,["modelValue","options"])])]),yt,r(Ue,{legend:t.$t("filter"),class:"filter-box map-card",collapsed:!0,toggleable:!0},{default:u(()=>[e("div",ht,[e("div",vt,[e("label",_t,a(t.$t("edu_type")),1),r(g,{multiple:"",modelValue:P.value,"onUpdate:modelValue":o[1]||(o[1]=n=>P.value=n),options:ne.value,label:x(y),reduce:n=>n.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),e("div",bt,[e("label",xt,a(t.$t("camera")),1),r(s,{modelValue:M.value,"onUpdate:modelValue":o[2]||(o[2]=n=>M.value=n)},null,8,["modelValue"])]),e("div",wt,[e("label",kt,a(t.$t("regions")),1),r(g,{modelValue:B.value,"onUpdate:modelValue":o[3]||(o[3]=n=>B.value=n),options:le.value,label:x(y),reduce:n=>n.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),e("div",It,[e("label",St,a(t.$t("districts")),1),r(g,{modelValue:T.value,"onUpdate:modelValue":o[4]||(o[4]=n=>T.value=n),options:se.value,label:x(y),reduce:n=>n.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),e("div",jt,[r(ge,{value:U.value.objects,selection:W.value,"onUpdate:selection":o[7]||(o[7]=n=>W.value=n),loading:X.value,dataKey:"id",selectionMode:"single",metaKeySelection:!1,onRowSelect:o[8]||(o[8]=n=>Me(W.value,"objects")),onRowUnselect:o[9]||(o[9]=n=>ze(W.value,"objects")),scrollable:"",scrollHeight:"350px",virtualScroll:""},{header:u(()=>[e("div",$t,[r(O,{iconPosition:"left",class:"block mt-2 md:mt-0"},{default:u(()=>[r(i,{class:"pi pi-search"}),r(D,{class:"w-full",modelValue:v.value.q,"onUpdate:modelValue":o[5]||(o[5]=n=>v.value.q=n),modelModifiers:{trim:!0},placeholder:t.$t("search")},null,8,["modelValue","placeholder"])]),_:1})])]),footer:u(()=>[e("div",Lt,[r(Oe,{onPage:Ee,page:v.value.page,"onUpdate:page":o[6]||(o[6]=n=>v.value.page=n),rows:v.value.limit,totalRecords:U.value.totalData,template:"FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink ",currentPageReportTemplate:`{first} - {last} ${t.$t("little_from")} {totalRecords}`},null,8,["page","rows","totalRecords","currentPageReportTemplate"])])]),default:u(()=>[r(_,{headerStyle:"width:14px;"},{body:u(n=>[Q(a(n.data.name[x(y)]),1)]),_:1})]),_:1},8,["value","selection","loading"])])])]),_:1},8,["legend"])])])]),r(ye,{visible:A.value,"onUpdate:visible":o[13]||(o[13]=n=>A.value=n),modal:!0,breakpoints:{"960px":"75vw"},style:we([{width:"60vw"},{"z-index":"1000"}])},{header:u(()=>{var n,p,E;return[e("h3",Ct,a((p=(n=N.value)==null?void 0:n.object[0])==null?void 0:p.name[x(y)]),1),e("p",Bt,a(t.$t("current_camera"))+": "+a((E=C.value)==null?void 0:E.comment),1)]}),default:u(()=>[e("div",null,[Tt,Et,e("div",Pt,[e("div",Mt,[e("div",zt,[e("button",{class:"o-button o-button-secondary",type:"button",onClick:o[10]||(o[10]=n=>De())},Vt)]),qt,Dt,e("div",Ot,[e("button",{class:"o-button o-button-warning",type:"button",onClick:o[11]||(o[11]=n=>Ve("JPEG"))},At)])]),e("div",Jt,[e("div",Nt,[e("p",Wt,a(t.$t("all_cameras"))+":",1),e("b",Ht,a(N.value.camInfo.length),1)]),e("div",Rt,[r(Ne,{class:"w-full"},{default:u(()=>[e("label",Gt,a(t.$t("camera")),1),r(Je,{class:"w-full",inputId:"camera",modelValue:C.value,"onUpdate:modelValue":o[12]||(o[12]=n=>C.value=n),options:N.value.camInfo,optionLabel:"comment",placeholder:t.$t("select")},{value:u(n=>{var p,E;return[(p=n.value)!=null&&p.comment?(S(),q("div",Kt,[e("div",null,a((E=n.value)==null?void 0:E.comment),1)])):(S(),q("span",Zt,a(n.placeholder),1))]}),option:u(n=>[e("div",Xt,[e("div",null,[r(Ae,{class:"mb-1",severity:n.option.code==0?"success":"danger"},null,8,["severity"]),Q(" "+a(n.option.comment),1)])])]),_:1},8,["modelValue","options","placeholder"])]),_:1})])])])])]),_:1},8,["visible"]),r(ye,{header:t.$t("more_info"),visible:h.value,"onUpdate:visible":o[15]||(o[15]=n=>h.value=n),modal:"",breakpoints:{"960px":"75vw"},style:{width:"60vw"}},{default:u(()=>[r(Re,{activeStep:k.value,"onUpdate:activeStep":o[14]||(o[14]=n=>k.value=n)},{default:u(()=>[r(ve,null,{header:u(({clickCallback:n})=>[e("div",{style:{cursor:"pointer"},onClick:n,class:"flex align-items-center"},[e("button",Yt,[e("span",{class:G(["border-round border-2 w-3rem h-3rem inline-flex align-items-center justify-content-center",{"bg-primary surface-border":k.value==0,"surface-border":k.value!==0}])},to,2)]),e("div",{class:G([{"text-primary surface-border":k.value==0}])},a(t.$t("edu_center")),3)],8,Qt)]),content:u(({nextCallback:n})=>[e("div",null,[e("div",oo,[e("div",lo,[e("div",so,[e("ul",no,[e("li",ao,[e("div",io,a(t.$t("edu_type"))+":",1),e("div",co,a(h.value.object.type[x(y)]),1)]),e("li",ro,[e("div",uo,a(t.$t("district"))+":",1),e("div",po,a(h.value.object.district[x(y)]),1)]),e("li",mo,[e("div",fo,a(t.$t("address"))+":",1),e("div",go,a(h.value.object.address[x(y)]),1)]),e("li",yo,[e("div",ho,a(t.$t("edu_center"))+":",1),e("div",vo,a(h.value.object.school[x(y)]),1)]),e("li",_o,[e("div",bo,a(t.$t("teachers_count"))+":",1),e("div",xo,a(h.value.object.teachers_count),1)]),e("li",wo,[e("div",ko,a(t.$t("students_count"))+":",1),e("div",Io,a(h.value.object.students_count),1)]),e("li",So,[e("div",jo,a(t.$t("shifts_count"))+":",1),e("div",$o,a(h.value.object.shifts_count),1)]),e("li",Lo,[e("div",Co,a(t.$t("guarding_technic_center"))+":",1),e("div",Bo,a(h.value.object.tqm[x(y)]=="null"?"":h.value.object.tqm[x(y)]),1)])])])]),e("div",To,[e("div",Eo,[r(lt,{images:h.value.photos},null,8,["images"])])]),e("div",Po,[r(He,null,{default:u(()=>[r(We,{header:t.$t("staffs")},{default:u(()=>[r(ge,{value:h.value.staff,selectionMode:"single",paginator:!0,rows:5,responsiveLayout:"scroll"},{default:u(()=>[r(_,{field:"name",header:t.$t("fio"),sortable:!0,headerStyle:"min-width:12rem;"},null,8,["header"]),r(_,{field:"position",header:t.$t("position"),headerStyle:"min-width:5rem;"},{body:u(p=>[Q(a(p.data.position[x(y)]),1)]),_:1},8,["header"]),r(_,{field:"phone",header:t.$t("phone"),sortable:!0,headerStyle:"min-width:8rem;"},null,8,["header"])]),_:1},8,["value"])]),_:1},8,["header"])]),_:1})])])]),e("div",Mo,[r(he,{label:"",icon:"pi pi-arrow-right",iconPos:"right",onClick:n},null,8,["onClick"])])]),_:1}),r(ve,null,{header:u(({clickCallback:n})=>[e("div",{style:{cursor:"pointer"},onClick:n,class:"flex align-items-center"},[e("div",{class:G([{"text-primary surface-border":k.value==1}])},a(t.$t("guarding_staffs")),3),e("button",Fo,[e("span",{class:G(["border-round border-2 w-3rem h-3rem inline-flex align-items-center justify-content-center",{"bg-primary surface-border":1<=k.value,"surface-border":1>k.value}])},qo,2)])],8,zo)]),content:u(({prevCallback:n})=>[e("div",null,[h.value.guard_staff?(S(),q("div",Do,[(S(!0),q(ke,null,Ye(h.value.guard_staff,p=>(S(),q("div",{key:p.id,class:"col p-1"},[e("div",Oo,[e("div",Uo,[e("div",Ao,[p.photo?(S(),be(c,{key:0,alt:"Image",preview:""},{image:u(()=>[e("img",{src:fe(p.photo),alt:"image",height:"240",style:{"border-radius":"10px"}},null,8,Jo)]),preview:u(E=>[e("img",{src:fe(p.photo),alt:"preview",style:we(E.style),onClick:E.onClick},null,12,No)]),_:2},1024)):xe("",!0),e("div",Wo,a(p.lastname)+" "+a(p.firstname)+" "+a(p.surname),1)]),e("div",Ho,[Ro,e("p",Go,a(p.phone),1)]),Ko,e("ul",Zo,[e("li",Xo,[Qo,e("p",Yo,a(p.birthdate.split("T")[0]),1)]),e("li",el,[tl,e("p",ol,a(p.pinfl),1)]),e("li",ll,[sl,e("p",nl,a(p.mil_service==0?t.$t("no"):t.$t("yes")),1)])]),al,e("div",il,[e("h6",dl,a(t.$t("work_from"))+":",1),e("p",null,a(p.work_from.split("T")[0]),1)])])])]))),128))])):(S(),q("div",cl,[e("h3",null,a(t.$t("no_data")),1)]))]),e("div",rl,[r(he,{label:"",severity:"secondary",icon:"pi pi-arrow-left",onClick:n},null,8,["onClick"])])]),_:1})]),_:1},8,["activeStep"])]),_:1},8,["header","visible"])],64)}}};export{vl as default};
