import{m as Z,u as x,r as c,o as ee,a as _,w as te,f as v,b as V,c as C,g as t,i as o,n,G as m,t as i,j as q,l as N}from"./index-aae41fd2.js";const ae={class:"grid"},le={class:"col-12"},se={class:"card"},oe=t("i",{class:"pi pi-upload mr-1"},null,-1),ie={class:"grid gap-3 ml-2 py-3"},de={class:"col-3 p-0",style:{width:"220px"}},ne={for:"region",class:"mb-3"},ce={class:"col-3 p-0",style:{width:"220px"}},re={for:"dictrict",class:"mb-3"},ue=t("i",{class:"pi pi-plus mr-1"},null,-1),me={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},pe={class:"m-0"},_e={class:"text-center"},ve=t("span",{class:"p-column-title"},"plate_number",-1),fe=t("span",{class:"p-column-title"},"cam_code",-1),ye=t("span",{class:"p-column-title"},"cam_type",-1),he=t("span",{class:"p-column-title"},"created_time",-1),be=["onClick"],ge=t("i",{class:"pi pi-pencil"},null,-1),$e=[ge],we=["onClick"],Ve=t("i",{class:"pi pi-trash mr-1"},null,-1),Ce=[Ve],ke={class:"field grid"},Ie={class:"col-6"},De={for:"cars"},qe=t("span",{style:{color:"#ff5050"}},"*",-1),Ne={key:0,class:"p-invalid"},Ue={class:"col-6"},Te={for:"cam_code"},Se=t("span",{style:{color:"#ff5050"}},"*",-1),Be={key:0,class:"p-invalid"},Pe={class:"field grid"},je={class:"col-6"},Fe={for:"cam_type"},ze=t("span",{style:{color:"#ff5050"}},"*",-1),Me={key:0,class:"p-invalid"},Ge={class:"flex align-items-center justify-content-center"},Ee=t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),Je={key:0},Ye={__name:"CarCameras",setup(Ke){const b=Z(),{t:r,locale:k}=x(),y=c(!1),$=c(!1),s=c({});c(null);const T=c(null),h=c(!1),S=c([]),U=c([]),B=c(),P=c(),I=c(!1),j=c([]);ee(async()=>{await w();const e=await _.get("/references/regions"),l=await _.get("/references/distcity"),p=await _.get("/users/cars"),f=await _.get("/references/camera-types");S.value=await e.data,U.value=await l.data,B.value=p.data,P.value=f.data});const d=c({q:"",limit:10,page:0,region:"",distcity:""});JSON.parse(localStorage.getItem("userData"));async function w(e){var l;try{I.value=!0;let p=`/references/car-cameras?page=${d.value.page+1}&limit=${d.value.limit}`,f=[];((l=d.value.q)==null?void 0:l.length)>2&&f.push(`q=${d.value.q}`),d.value.region&&f.push(`region=${d.value.region}`),d.value.distcity&&f.push(`distcity=${d.value.distcity}`),f.length>0&&(p+="&"+f.join("&")),j.value=await _.get(p),I.value=!1}catch{I.value=!1}}async function G(e){const l=await _.get(`/references/distcity?region=${d.value.region}`);U.value=await l.data}const E=()=>{s.value={car_id:"",cam_code:null,cam_type:""},h.value=!1,y.value=!0};te(()=>d.value,async()=>{G(),w()},{deep:!0});const J=()=>{y.value=!1,h.value=!1},K=async()=>{if(h.value=!0,!!s.value.car_id&&s.value.cam_code&&s.value.cam_type)if(s.value.id)try{await _.put(`/references/car-cameras/${s.value.id}`,s.value),w(s.value.id),b.add({severity:"success",summary:r("status"),detail:r("success"),life:3e3}),y.value=!1,s.value={}}catch{b.add({severity:"error",summary:r("status"),detail:r("error"),life:3e3})}else try{await _.post("/references/car-cameras",s.value),w(),b.add({severity:"success",summary:r("status"),detail:r("success"),life:3e3}),y.value=!1,s.value={}}catch{b.add({severity:"error",summary:r("status"),detail:r("error"),life:3e3})}},O=async e=>{const l=await _.get(`/references/car-cameras/${e.id}`);s.value=l.data,y.value=!0},Y=e=>{s.value.id=e,$.value=!0},A=async()=>{try{await _.delete(`/references/car-cameras/${s.value.id}`),$.value=!1,s.value={},b.add({severity:"success",summary:r("status"),detail:r("success"),life:3e3}),w()}catch{b.add({severity:"error",summary:r("status"),detail:r("error"),life:3e3})}},H=()=>{T.value.exportCSV()};return(e,l)=>{var z,M;const p=v("v-select"),f=v("Toolbar"),L=v("InputIcon"),Q=v("InputText"),R=v("IconField"),g=v("Column"),W=v("DataTable"),X=v("InputNumber"),D=v("Button"),F=v("Dialog");return V(),C("div",ae,[t("div",le,[t("div",se,[o(f,{class:"mb-4"},{start:n(()=>[t("button",{class:"o-button o-button-secondary mr-2",onClick:l[0]||(l[0]=a=>H(a))},[oe,m(" "+i(e.$t("save")),1)]),t("div",ie,[t("div",de,[t("label",ne,i(e.$t("regions")),1),o(p,{id:"region",modelValue:d.value.region,"onUpdate:modelValue":l[1]||(l[1]=a=>d.value.region=a),options:S.value,label:q(k),reduce:a=>a.id,placeholder:e.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),t("div",ce,[t("label",re,i(e.$t("districts")),1),o(p,{id:"dictrict",modelValue:d.value.distcity,"onUpdate:modelValue":l[2]||(l[2]=a=>d.value.distcity=a),options:U.value,label:q(k),reduce:a=>a.id,placeholder:e.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])])])]),end:n(()=>[t("button",{class:"o-button o-button-success",onClick:E},[ue,m(i(e.$t("add")),1)])]),_:1}),o(W,{ref_key:"dt",ref:T,filters:e.filters,"onUpdate:filters":l[4]||(l[4]=a=>e.filters=a),value:(M=(z=j.value)==null?void 0:z.data)==null?void 0:M.data,paginator:"",rows:10,dataKey:"id",loading:I.value,globalFilterFields:["uz","oz","ru","id"]},{header:n(()=>[t("div",me,[t("h5",pe,i(e.$t("car_cameras")),1),o(R,{iconPosition:"left",class:"block mt-2 md:mt-0"},{default:n(()=>[o(L,{class:"pi pi-search"}),o(Q,{class:"w-full sm:w-auto",modelValue:d.value.q,"onUpdate:modelValue":l[3]||(l[3]=a=>d.value.q=a),modelModifiers:{trim:!0},placeholder:e.$t("search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:n(()=>[t("div",_e,i(e.$t("no_data")),1)]),default:n(()=>[o(g,{header:e.$t("â„–"),headerStyle:"width:14px;"},{body:n(a=>[m(i(a.index+1),1)]),_:1},8,["header"]),o(g,{field:"plate_number",header:e.$t("plate_number"),sortable:!0},{body:n(a=>[ve,m(" "+i(a.data.plate_number),1)]),_:1},8,["header"]),o(g,{field:"cam_code",header:e.$t("cam_code"),sortable:!0},{body:n(a=>[fe,m(" "+i(a.data.cam_code),1)]),_:1},8,["header"]),o(g,{field:"cam_type",header:e.$t("cam_type"),sortable:!0},{body:n(a=>[ye,m(" "+i(a.data.cam_type[q(k)]),1)]),_:1},8,["header"]),o(g,{field:"created_time",header:e.$t("created_time"),sortable:!0},{body:n(a=>[he,m(" "+i(a.data.created_time),1)]),_:1},8,["header"]),o(g,{header:e.$t("actions"),headerStyle:"min-width:10rem;"},{body:n(a=>[t("button",{class:"o-button o-button-warning mr-2",onClick:u=>O(a.data)},$e,8,be),t("button",{class:"o-button o-button-danger",onClick:u=>Y(a.data.id)},Ce,8,we)]),_:1},8,["header"])]),_:1},8,["filters","value","loading"]),o(F,{visible:y.value,"onUpdate:visible":l[8]||(l[8]=a=>y.value=a),style:{width:"750px"},header:s.value.id?e.$t("edit"):e.$t("add"),modal:!0,class:"p-fluid"},{footer:n(()=>[o(D,{label:e.$t("cancel"),icon:"pi pi-times",class:"text-red-400",text:"",onClick:J},null,8,["label"]),o(D,{label:e.$t("save"),icon:"pi pi-check",text:"",onClick:K},null,8,["label"])]),default:n(()=>{var a;return[t("div",ke,[t("div",Ie,[t("label",De,[m(i(e.$t("cars")),1),qe]),o(p,{id:"cars",modelValue:s.value.car_id,"onUpdate:modelValue":l[5]||(l[5]=u=>s.value.car_id=u),options:B.value,label:"plate_number",reduce:u=>u.id,placeholder:e.$t("select")},null,8,["modelValue","options","reduce","placeholder"]),h.value&&!s.value.car_id?(V(),C("small",Ne,i(e.$t("field_required")),1)):N("",!0)]),t("div",Ue,[t("label",Te,[m(i(e.$t("cam_code")),1),Se]),o(X,{id:"cam_code",modelValue:s.value.cam_code,"onUpdate:modelValue":l[6]||(l[6]=u=>s.value.cam_code=u),modelModifiers:{trim:!0},required:"true",invalid:h.value&&!((a=s.value.cam_code)!=null&&a.length),inputId:"withoutgrouping",useGrouping:!1,fluid:""},null,8,["modelValue","invalid"]),h.value&&!s.value.cam_code?(V(),C("small",Be,i(e.$t("field_required")),1)):N("",!0)])]),t("div",Pe,[t("div",je,[t("label",Fe,[m(i(e.$t("cam_type")),1),ze]),o(p,{id:"cam_type",modelValue:s.value.cam_type,"onUpdate:modelValue":l[7]||(l[7]=u=>s.value.cam_type=u),options:P.value,label:q(k),reduce:u=>u.id,placeholder:e.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"]),h.value&&!s.value.cam_type?(V(),C("small",Me,i(e.$t("field_required")),1)):N("",!0)])])]}),_:1},8,["visible","header"]),o(F,{visible:$.value,"onUpdate:visible":l[10]||(l[10]=a=>$.value=a),style:{width:"450px"},header:e.$t("confirmation"),modal:!0},{footer:n(()=>[o(D,{label:"No",icon:"pi pi-times",text:"",onClick:l[9]||(l[9]=a=>$.value=!1)}),o(D,{label:"Yes",icon:"pi pi-check",text:"",onClick:A})]),default:n(()=>[t("div",Ge,[Ee,s.value?(V(),C("span",Je,[m(i(e.$t("are_you_sure_to_delete_this_item"))+" ",1),t("b",null,i(s.value.name),1)])):N("",!0)])]),_:1},8,["visible","header"])])])])}}};export{Ye as default};
