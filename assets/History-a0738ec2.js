import{Q as E,R as G,m as J,u as Q,r as m,o as W,a as _,w as z,f as h,b as v,c as X,g as l,i,n as r,G as u,t as d,j as o,k as q}from"./index-aae41fd2.js";const Y=E("history",{state:()=>({filterData:{q:"",limit:10,page:0,region:"",distcity:"",state:"",type:"",is_accepted:"",period:""}}),actions:{}});const Z={class:"grid"},x={class:"col-12"},ee={class:"card"},te=l("i",{class:"pi pi-upload mr-1"},null,-1),ae={class:"grid gap-3 ml-2 py-3"},le={class:"col-3 p-0",style:{width:"220px"}},se={for:"region",class:"mb-3"},oe={class:"col-3 p-0",style:{width:"220px"}},ie={for:"dictrict",class:"mb-3"},de={class:"col-3 p-0",style:{width:"220px"}},re={for:"status",class:"mb-3"},ne={class:"col-3 p-0",style:{width:"220px"}},ce={for:"type",class:"mb-3"},pe={class:"col-3 p-0",style:{width:"200px"}},ue={for:"accepted",class:"mb-3"},me={class:"col-3 p-0",style:{width:"180px"}},he={for:"period",class:"mb-3"},fe={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},_e={class:"m-0"},ye={class:"text-center"},be=l("span",{class:"p-column-title"},"region",-1),ge=l("span",{class:"p-column-title"},"address",-1),we=l("span",{class:"p-column-title"},"name",-1),$e=l("span",{class:"p-column-title"},"type",-1),De=l("span",{class:"p-column-title"},"state",-1),ve=l("span",{class:"p-column-title"},"main_or_additional",-1),Ve=l("span",{class:"p-column-title"},"time",-1),Se=l("span",{class:"p-column-title"},"card_number",-1),ke=l("span",{class:"p-column-title"},"is_accepted",-1),Pe=["onClick"],Re=l("i",{class:"pi pi-angle-right"},null,-1),Ie=[Re],Te={class:"p-0"},Le={__name:"History",setup(Ce){const V=G();J();const{t:Ue,locale:f}=Q(),a=Y();m({});const S=m(null),k=m(null),P=m([]),g=m([]),R=m(),I=m(),b=m(!1),w=m([]);W(async()=>{await $();const t=await _.get("/references/regions"),s=await _.get("/references/distcity"),c=await _.get("/references/alarm-types"),n=await _.get("/references/alarm-states");P.value=await t.data,g.value=await s.data,R.value=n.data,I.value=c.data}),JSON.parse(localStorage.getItem("userData"));async function $(t){var s;try{b.value=!0;let c=`/history/alarms?page=${a.filterData.page+1}&limit=${a.filterData.limit}`,n=[];if(((s=a.filterData.q)==null?void 0:s.length)>2&&n.push(`q=${a.filterData.q}`),a.filterData.region&&n.push(`region=${a.filterData.region}`),a.filterData.distcity&&n.push(`distcity=${a.filterData.distcity}`),a.filterData.state&&n.push(`state=${a.filterData.state}`),a.filterData.type&&n.push(`type=${a.filterData.type}`),a.filterData.is_accepted){let y;a.filterData.is_accepted==1?y=!1:y=!0,n.push(`is_accepted=${y}`)}a.filterData.period&&n.push(`period=${a.filterData.period}`),n.length>0&&(c+="&"+n.join("&")),w.value=await _.get(c),b.value=!1}catch{b.value=!1}}function L(t){N()}async function N(t){const s=await _.get(`/references/distcity?region=${a.filterData.region}`);g.value=await s.data}z(()=>a.filterData,async()=>{$()},{deep:!0});function B(t){V.push(`/pages/history/${t.data.id}`)}function M(t){a.filterData.page=t.page,a.filterData.limit=t.rows,$()}const j=()=>{k.value.exportCSV()};return(t,s)=>{var C,U;const c=h("v-select"),n=h("Toolbar"),y=h("InputIcon"),A=h("InputText"),F=h("IconField"),p=h("Column"),T=h("Avatar"),H=h("Paginator"),K=h("DataTable");return v(),X("div",Z,[l("div",x,[l("div",ee,[i(n,{class:"mb-4"},{start:r(()=>[l("button",{class:"o-button o-button-secondary mr-2",onClick:s[0]||(s[0]=e=>j(e))},[te,u(" "+d(t.$t("save")),1)]),l("div",ae,[l("div",le,[l("label",se,d(t.$t("regions")),1),i(c,{id:"region","onUpdate:modelValue":[L,s[1]||(s[1]=e=>o(a).filterData.region=e)],modelValue:o(a).filterData.region,options:P.value,label:o(f),reduce:e=>e.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),l("div",oe,[l("label",ie,d(t.$t("districts")),1),i(c,{id:"dictrict",modelValue:o(a).filterData.distcity,"onUpdate:modelValue":s[2]||(s[2]=e=>o(a).filterData.distcity=e),options:g.value,label:o(f),reduce:e=>e.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),l("div",de,[l("label",re,d(t.$t("status")),1),i(c,{id:"status",modelValue:o(a).filterData.state,"onUpdate:modelValue":s[3]||(s[3]=e=>o(a).filterData.state=e),options:R.value,label:o(f),reduce:e=>e.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),l("div",ne,[l("label",ce,d(t.$t("type")),1),i(c,{id:"type",modelValue:o(a).filterData.type,"onUpdate:modelValue":s[4]||(s[4]=e=>o(a).filterData.type=e),options:I.value,label:o(f),reduce:e=>e.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),l("div",pe,[l("label",ue,d(t.$t("accepted"))+"?",1),i(c,{id:"accepted",modelValue:o(a).filterData.is_accepted,"onUpdate:modelValue":s[5]||(s[5]=e=>o(a).filterData.is_accepted=e),options:[{id:1,label:t.$t("no")},{id:2,label:t.$t("yes")}],clearable:!0,label:t.label,reduce:e=>e.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])]),l("div",me,[l("label",he,d(t.$t("period"))+"?",1),i(c,{id:"period",modelValue:o(a).filterData.period,"onUpdate:modelValue":s[6]||(s[6]=e=>o(a).filterData.period=e),options:[{id:1,label:t.$t("Daily")},{id:2,label:t.$t("Weekly")},{id:3,label:t.$t("Ten_daily")},{id:4,label:t.$t("Monthly")}],clearable:!0,label:t.label,reduce:e=>e.id,placeholder:t.$t("select")},null,8,["modelValue","options","label","reduce","placeholder"])])])]),_:1}),i(K,{ref_key:"dt",ref:k,value:(U=(C=w.value)==null?void 0:C.data)==null?void 0:U.data,selection:S.value,"onUpdate:selection":s[9]||(s[9]=e=>S.value=e),dataKey:"id",selectionMode:"single",onRowSelect:B,metaKeySelection:!1,loading:b.value},{header:r(()=>[l("div",fe,[l("h5",_e,d(t.$t("history_of_alarmings")),1),i(F,{iconPosition:"left",class:"block mt-2 md:mt-0"},{default:r(()=>[i(y,{class:"pi pi-search"}),i(A,{class:"w-full sm:w-auto",modelValue:o(a).filterData.q,"onUpdate:modelValue":s[7]||(s[7]=e=>o(a).filterData.q=e),modelModifiers:{trim:!0},placeholder:t.$t("search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:r(()=>[l("div",ye,d(t.$t("no_data")),1)]),footer:r(()=>{var e,D;return[l("div",Te,[i(H,{onPage:M,page:o(a).filterData.page,"onUpdate:page":s[8]||(s[8]=O=>o(a).filterData.page=O),rows:o(a).filterData.limit,rowsPerPageOptions:[10,20,50,100,500],totalRecords:(D=(e=w.value)==null?void 0:e.data)==null?void 0:D.totalData,template:"FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:`{first} - {last} ${t.$t("to")}. ${t.$t("all")}: {totalRecords}`},null,8,["page","rows","totalRecords","currentPageReportTemplate"])])]}),default:r(()=>[i(p,{header:t.$t("â„–"),headerStyle:"width:14px;"},{body:r(e=>[u(d(e.index+1),1)]),_:1},8,["header"]),i(p,{field:"region",header:t.$t("region"),sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[be,u(" "+d(e.data.region[o(f)]),1)]),_:1},8,["header"]),i(p,{field:"address",header:t.$t("address"),sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[ge,u(" "+d(e.data.address),1)]),_:1},8,["header"]),i(p,{field:"name",header:t.$t("name"),sortable:!1,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[we,u(" "+d(e.data.name),1)]),_:1},8,["header"]),i(p,{field:"type",header:t.$t("type"),sortable:!1,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[$e,u(" "+d(e.data.type[o(f)]),1)]),_:1},8,["header"]),i(p,{field:"state",header:t.$t("status"),sortable:!1,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[De,u(" "+d(e.data.state[o(f)]),1)]),_:1},8,["header"]),i(p,{field:"main_or_additional",header:t.$t("main_or_additional"),sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[ve,u(" "+d(e.data.main_or_additional[o(f)]),1)]),_:1},8,["header"]),i(p,{field:"time",header:t.$t("time"),sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[Ve,u(" "+d(e.data.time),1)]),_:1},8,["header"]),i(p,{field:"card_number",header:t.$t("card_number"),sortable:!1,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[Se,u(" "+d(e.data.card_number),1)]),_:1},8,["header"]),i(p,{field:"is_accepted",header:t.$t("accepted"),sortable:!1,headerStyle:"width:14%; min-width:10rem;"},{body:r(e=>[ke,e.data.is_accepted?(v(),q(T,{key:0,icon:"pi pi-check",style:{"background-color":"#4ade80",color:"#000"},shape:"circle"})):(v(),q(T,{key:1,icon:"pi pi-times",style:{"background-color":"#ff0000",color:"#fff"},shape:"circle"}))]),_:1},8,["header"]),i(p,{header:t.$t("actions"),headerStyle:"min-width:10rem;"},{body:r(e=>[l("button",{class:"o-button o-button-secondary mr-2",onClick:D=>o(V).push(`/pages/history/${e.data.id}`)},Ie,8,Pe)]),_:1},8,["header"])]),_:1},8,["value","selection","loading"])])])])}}};export{Le as default};
